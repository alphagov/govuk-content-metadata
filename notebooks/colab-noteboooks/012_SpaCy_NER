{"cells":[{"cell_type":"markdown","metadata":{"id":"_BGkg8TDDqZY"},"source":["# Off the shelf NER models"]},{"cell_type":"markdown","metadata":{"id":"CLqcq8RODRjQ"},"source":["This notebook utilises off the shelf NER models to identify named entities within text. The goal is to qualitatively examine their ability to identify and correctly label entities containing language specific to the gov.uk domain."]},{"cell_type":"code","execution_count":null,"metadata":{"id":"JD3tyJ2z-HcP"},"outputs":[],"source":["!pip install --upgrade spacy==3.2.1\n","!pip install spacy[transformers]"]},{"cell_type":"code","execution_count":82,"metadata":{"id":"C7ciT3UyDLpE","executionInfo":{"status":"ok","timestamp":1642168592780,"user_tz":0,"elapsed":213,"user":{"displayName":"Jake Rutherford","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"06919904590009580026"}}},"outputs":[],"source":["# import libraries\n","import pandas as pd\n","import numpy as np\n","from google.colab import drive\n","import os\n","import ast\n","import spacy\n","from spacy import displacy\n","from spacy.scorer import Scorer\n","from spacy.tokens import Doc\n","from spacy.tokens import Span\n","from spacy.training.example import Example\n","from tqdm.notebook import tqdm\n","\n","import requests\n","from bs4 import BeautifulSoup\n"]},{"cell_type":"markdown","metadata":{"id":"DjQw2-vLF9g2"},"source":["### Load data"]},{"cell_type":"markdown","source":["We're going to assess the performance on our validated testing data available at https://drive.google.com/drive/folders/1ZTwi2ZP0RiqBW3gijgDGKvitayVUL8I4"],"metadata":{"id":"qT6AoVISsY_J"}},{"cell_type":"code","execution_count":3,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":21169,"status":"ok","timestamp":1642165164813,"user":{"displayName":"Jake Rutherford","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"06919904590009580026"},"user_tz":0},"id":"5IMxanGvGPhr","outputId":"c1d56060-4416-41b3-d269-05b7052e8743"},"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}],"source":["drive.mount('/content/drive')"]},{"cell_type":"code","execution_count":20,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":609,"status":"ok","timestamp":1642165603556,"user":{"displayName":"Jake Rutherford","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"06919904590009580026"},"user_tz":0},"id":"EMiv4TAGGAaY","outputId":"b6f4d72a-2cca-4239-ab3d-1a12e08ce81e"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["['validated_test.csv', 'validated_train.csv', 'unvalidated_train.csv']"]},"metadata":{},"execution_count":20}],"source":["DATA_DIR = 'drive/Shareddrives/GOV.UK teams/2020-2021/Data labs/content-metadata-2021/Data/Jan2022-Data/Jan22-CSV'\n","os.listdir(DATA_DIR)"]},{"cell_type":"code","execution_count":21,"metadata":{"id":"Y16ieRqxGSSy","executionInfo":{"status":"ok","timestamp":1642165623585,"user_tz":0,"elapsed":517,"user":{"displayName":"Jake Rutherford","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"06919904590009580026"}}},"outputs":[],"source":["df = pd.read_csv(DATA_DIR + '/validated_test.csv')"]},{"cell_type":"code","source":["df.head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":337},"id":"Z3ksViqtTGJB","executionInfo":{"status":"ok","timestamp":1642165625369,"user_tz":0,"elapsed":202,"user":{"displayName":"Jake Rutherford","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"06919904590009580026"}},"outputId":"7052b026-5a47-4f6f-c2ad-ec153eb35870"},"execution_count":22,"outputs":[{"output_type":"execute_result","data":{"text/html":["\n","  <div id=\"df-2768b8a1-a728-455a-9455-a5ccf8701b63\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>text</th>\n","      <th>labels</th>\n","      <th>labelled_entities</th>\n","      <th>label_list</th>\n","      <th>text_tokens</th>\n","      <th>new_label_list_id</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>Contact your local council for more information .</td>\n","      <td>[[19, 26, 'ORGANIZATION']]</td>\n","      <td>[('council', 'ORGANIZATION')]</td>\n","      <td>['O', 'O', 'O', 'I-ORGANIZATION', 'O', 'O', 'O...</td>\n","      <td>['Contact', 'your', 'local', 'council', 'for',...</td>\n","      <td>[0, 0, 0, 8, 0, 0, 0, 0]</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>Long - term Staff Apply for this visa if you ’...</td>\n","      <td>[[0, 17, 'PERSON'], [33, 37, 'FORM'], [141, 14...</td>\n","      <td>[('Long - term Staff', 'PERSON'), ('visa', 'FO...</td>\n","      <td>['I-PERSON', 'I-PERSON', 'I-PERSON', 'I-PERSON...</td>\n","      <td>['Long', '-', 'term', 'Staff', 'Apply', 'for',...</td>\n","      <td>[9, 9, 9, 9, 0, 0, 0, 5, 0, 0, 0, 0, 0, 0, 0, ...</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>Pay the court fee Pay by credit or debit card ...</td>\n","      <td>[[8, 17, 'FINANCE'], [25, 45, 'FINANCE'], [67,...</td>\n","      <td>[('court fee', 'FINANCE'), ('credit or debit c...</td>\n","      <td>['O', 'O', 'I-FINANCE', 'I-FINANCE', 'O', 'O',...</td>\n","      <td>['Pay', 'the', 'court', 'fee', 'Pay', 'by', 'c...</td>\n","      <td>[0, 0, 4, 4, 0, 0, 4, 4, 4, 4, 0, 0, 0, 0, 0, ...</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>After you ’ ve signed the declaration or form ...</td>\n","      <td>[[26, 37, 'FINANCE'], [75, 82, 'PERSON'], [95,...</td>\n","      <td>[('declaration', 'FINANCE'), ('members', 'PERS...</td>\n","      <td>['O', 'O', 'O', 'O', 'O', 'O', 'I-FINANCE', 'O...</td>\n","      <td>['After', 'you', '’', 've', 'signed', 'the', '...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 4, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>There ’ s a different form for individuals and...</td>\n","      <td>[[31, 42, 'PERSON'], [47, 56, 'ORGANIZATION'],...</td>\n","      <td>[('individuals', 'PERSON'), ('companies', 'ORG...</td>\n","      <td>['O', 'O', 'O', 'O', 'O', 'O', 'O', 'I-PERSON'...</td>\n","      <td>['There', '’', 's', 'a', 'different', 'form', ...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 9, 0, 8, 0, 0, 4, 4, 4, ...</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-2768b8a1-a728-455a-9455-a5ccf8701b63')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-2768b8a1-a728-455a-9455-a5ccf8701b63 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-2768b8a1-a728-455a-9455-a5ccf8701b63');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "],"text/plain":["                                                text  ...                                  new_label_list_id\n","0  Contact your local council for more information .  ...                           [0, 0, 0, 8, 0, 0, 0, 0]\n","1  Long - term Staff Apply for this visa if you ’...  ...  [9, 9, 9, 9, 0, 0, 0, 5, 0, 0, 0, 0, 0, 0, 0, ...\n","2  Pay the court fee Pay by credit or debit card ...  ...  [0, 0, 4, 4, 0, 0, 4, 4, 4, 4, 0, 0, 0, 0, 0, ...\n","3  After you ’ ve signed the declaration or form ...  ...  [0, 0, 0, 0, 0, 0, 4, 0, 0, 0, 0, 0, 0, 0, 0, ...\n","4  There ’ s a different form for individuals and...  ...  [0, 0, 0, 0, 0, 0, 0, 9, 0, 8, 0, 0, 4, 4, 4, ...\n","\n","[5 rows x 6 columns]"]},"metadata":{},"execution_count":22}]},{"cell_type":"code","execution_count":23,"metadata":{"id":"jPt7FWd1Nq_L","executionInfo":{"status":"ok","timestamp":1642165660513,"user_tz":0,"elapsed":206,"user":{"displayName":"Jake Rutherford","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"06919904590009580026"}}},"outputs":[],"source":["# some columns are string literals and need to be converted back to lists\n","literals = ['text_tokens','labels','label_list','labelled_entities']\n","df[literals] = df[literals].applymap(ast.literal_eval)"]},{"cell_type":"code","execution_count":24,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":240},"executionInfo":{"elapsed":220,"status":"ok","timestamp":1642165662501,"user":{"displayName":"Jake Rutherford","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"06919904590009580026"},"user_tz":0},"id":"FgZrVx90IOUM","outputId":"01cae0a9-904a-4525-9301-ace2dc34c566"},"outputs":[{"output_type":"execute_result","data":{"text/html":["\n","  <div id=\"df-07c1c2b0-8a55-400b-8797-8531f8c46a12\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>text</th>\n","      <th>labels</th>\n","      <th>labelled_entities</th>\n","      <th>label_list</th>\n","      <th>text_tokens</th>\n","      <th>new_label_list_id</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>48</th>\n","      <td>How to apply Contact your local Jobcentre Plus...</td>\n","      <td>[[32, 46, ORGANIZATION]]</td>\n","      <td>[(Jobcentre Plus, ORGANIZATION)]</td>\n","      <td>[O, O, O, O, O, O, I-ORGANIZATION, I-ORGANIZAT...</td>\n","      <td>[How, to, apply, Contact, your, local, Jobcent...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 8, 8, 0, 0, 0]</td>\n","    </tr>\n","    <tr>\n","      <th>728</th>\n","      <td>You cannot complain about the decision - you c...</td>\n","      <td>[[73, 87, PERSON], [104, 111, EVENT]]</td>\n","      <td>[(tribunal staff, PERSON), (hearing, EVENT)]</td>\n","      <td>[O, O, O, O, O, O, O, O, O, O, O, O, O, I-PERS...</td>\n","      <td>[You, cannot, complain, about, the, decision, ...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 9, ...</td>\n","    </tr>\n","    <tr>\n","      <th>975</th>\n","      <td>Variable payment plan You can set up regular a...</td>\n","      <td>[[55, 76, FINANCE]]</td>\n","      <td>[(Direct Debit payments, FINANCE)]</td>\n","      <td>[O, O, O, O, O, O, O, O, O, I-FINANCE, I-FINAN...</td>\n","      <td>[Variable, payment, plan, You, can, set, up, r...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 4, 4, 0, 0, 0]</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-07c1c2b0-8a55-400b-8797-8531f8c46a12')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-07c1c2b0-8a55-400b-8797-8531f8c46a12 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-07c1c2b0-8a55-400b-8797-8531f8c46a12');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "],"text/plain":["                                                  text  ...                                  new_label_list_id\n","48   How to apply Contact your local Jobcentre Plus...  ...                  [0, 0, 0, 0, 0, 0, 8, 8, 0, 0, 0]\n","728  You cannot complain about the decision - you c...  ...  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 9, ...\n","975  Variable payment plan You can set up regular a...  ...      [0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 4, 4, 0, 0, 0]\n","\n","[3 rows x 6 columns]"]},"metadata":{},"execution_count":24}],"source":["df.sample(3)"]},{"cell_type":"markdown","metadata":{"id":"DXSxOE7f3O6n"},"source":["## Spacy"]},{"cell_type":"markdown","metadata":{"id":"NJ99NDzqTvpi"},"source":["Spacy utilises Roberta-base in their NER model."]},{"cell_type":"code","execution_count":9,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":43253,"status":"ok","timestamp":1642165211830,"user":{"displayName":"Jake Rutherford","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"06919904590009580026"},"user_tz":0},"id":"YUbgAVCA_8Qm","outputId":"f8d09d05-ab46-4e57-bf94-0d7c2cc3b23a"},"outputs":[{"output_type":"stream","name":"stdout","text":["Collecting en-core-web-trf==3.2.0\n","  Downloading https://github.com/explosion/spacy-models/releases/download/en_core_web_trf-3.2.0/en_core_web_trf-3.2.0-py3-none-any.whl (460.2 MB)\n","\u001b[K     |████████████████████████████████| 460.2 MB 32 kB/s \n","\u001b[?25hRequirement already satisfied: spacy<3.3.0,>=3.2.0 in /usr/local/lib/python3.7/dist-packages (from en-core-web-trf==3.2.0) (3.2.1)\n","Requirement already satisfied: spacy-transformers<1.2.0,>=1.1.2 in /usr/local/lib/python3.7/dist-packages (from en-core-web-trf==3.2.0) (1.1.4)\n","Requirement already satisfied: catalogue<2.1.0,>=2.0.6 in /usr/local/lib/python3.7/dist-packages (from spacy<3.3.0,>=3.2.0->en-core-web-trf==3.2.0) (2.0.6)\n","Requirement already satisfied: jinja2 in /usr/local/lib/python3.7/dist-packages (from spacy<3.3.0,>=3.2.0->en-core-web-trf==3.2.0) (2.11.3)\n","Requirement already satisfied: tqdm<5.0.0,>=4.38.0 in /usr/local/lib/python3.7/dist-packages (from spacy<3.3.0,>=3.2.0->en-core-web-trf==3.2.0) (4.62.3)\n","Requirement already satisfied: typer<0.5.0,>=0.3.0 in /usr/local/lib/python3.7/dist-packages (from spacy<3.3.0,>=3.2.0->en-core-web-trf==3.2.0) (0.4.0)\n","Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.7/dist-packages (from spacy<3.3.0,>=3.2.0->en-core-web-trf==3.2.0) (21.3)\n","Requirement already satisfied: cymem<2.1.0,>=2.0.2 in /usr/local/lib/python3.7/dist-packages (from spacy<3.3.0,>=3.2.0->en-core-web-trf==3.2.0) (2.0.6)\n","Requirement already satisfied: murmurhash<1.1.0,>=0.28.0 in /usr/local/lib/python3.7/dist-packages (from spacy<3.3.0,>=3.2.0->en-core-web-trf==3.2.0) (1.0.6)\n","Requirement already satisfied: requests<3.0.0,>=2.13.0 in /usr/local/lib/python3.7/dist-packages (from spacy<3.3.0,>=3.2.0->en-core-web-trf==3.2.0) (2.23.0)\n","Requirement already satisfied: blis<0.8.0,>=0.4.0 in /usr/local/lib/python3.7/dist-packages (from spacy<3.3.0,>=3.2.0->en-core-web-trf==3.2.0) (0.4.1)\n","Requirement already satisfied: wasabi<1.1.0,>=0.8.1 in /usr/local/lib/python3.7/dist-packages (from spacy<3.3.0,>=3.2.0->en-core-web-trf==3.2.0) (0.9.0)\n","Requirement already satisfied: spacy-loggers<2.0.0,>=1.0.0 in /usr/local/lib/python3.7/dist-packages (from spacy<3.3.0,>=3.2.0->en-core-web-trf==3.2.0) (1.0.1)\n","Requirement already satisfied: pathy>=0.3.5 in /usr/local/lib/python3.7/dist-packages (from spacy<3.3.0,>=3.2.0->en-core-web-trf==3.2.0) (0.6.1)\n","Requirement already satisfied: srsly<3.0.0,>=2.4.1 in /usr/local/lib/python3.7/dist-packages (from spacy<3.3.0,>=3.2.0->en-core-web-trf==3.2.0) (2.4.2)\n","Requirement already satisfied: preshed<3.1.0,>=3.0.2 in /usr/local/lib/python3.7/dist-packages (from spacy<3.3.0,>=3.2.0->en-core-web-trf==3.2.0) (3.0.6)\n","Requirement already satisfied: numpy>=1.15.0 in /usr/local/lib/python3.7/dist-packages (from spacy<3.3.0,>=3.2.0->en-core-web-trf==3.2.0) (1.19.5)\n","Requirement already satisfied: pydantic!=1.8,!=1.8.1,<1.9.0,>=1.7.4 in /usr/local/lib/python3.7/dist-packages (from spacy<3.3.0,>=3.2.0->en-core-web-trf==3.2.0) (1.8.2)\n","Requirement already satisfied: setuptools in /usr/local/lib/python3.7/dist-packages (from spacy<3.3.0,>=3.2.0->en-core-web-trf==3.2.0) (57.4.0)\n","Requirement already satisfied: langcodes<4.0.0,>=3.2.0 in /usr/local/lib/python3.7/dist-packages (from spacy<3.3.0,>=3.2.0->en-core-web-trf==3.2.0) (3.3.0)\n","Requirement already satisfied: typing-extensions<4.0.0.0,>=3.7.4 in /usr/local/lib/python3.7/dist-packages (from spacy<3.3.0,>=3.2.0->en-core-web-trf==3.2.0) (3.10.0.2)\n","Requirement already satisfied: spacy-legacy<3.1.0,>=3.0.8 in /usr/local/lib/python3.7/dist-packages (from spacy<3.3.0,>=3.2.0->en-core-web-trf==3.2.0) (3.0.8)\n","Requirement already satisfied: thinc<8.1.0,>=8.0.12 in /usr/local/lib/python3.7/dist-packages (from spacy<3.3.0,>=3.2.0->en-core-web-trf==3.2.0) (8.0.13)\n","Requirement already satisfied: zipp>=0.5 in /usr/local/lib/python3.7/dist-packages (from catalogue<2.1.0,>=2.0.6->spacy<3.3.0,>=3.2.0->en-core-web-trf==3.2.0) (3.7.0)\n","Requirement already satisfied: pyparsing!=3.0.5,>=2.0.2 in /usr/local/lib/python3.7/dist-packages (from packaging>=20.0->spacy<3.3.0,>=3.2.0->en-core-web-trf==3.2.0) (3.0.6)\n","Requirement already satisfied: smart-open<6.0.0,>=5.0.0 in /usr/local/lib/python3.7/dist-packages (from pathy>=0.3.5->spacy<3.3.0,>=3.2.0->en-core-web-trf==3.2.0) (5.2.1)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.7/dist-packages (from requests<3.0.0,>=2.13.0->spacy<3.3.0,>=3.2.0->en-core-web-trf==3.2.0) (2021.10.8)\n","Requirement already satisfied: idna<3,>=2.5 in /usr/local/lib/python3.7/dist-packages (from requests<3.0.0,>=2.13.0->spacy<3.3.0,>=3.2.0->en-core-web-trf==3.2.0) (2.10)\n","Requirement already satisfied: chardet<4,>=3.0.2 in /usr/local/lib/python3.7/dist-packages (from requests<3.0.0,>=2.13.0->spacy<3.3.0,>=3.2.0->en-core-web-trf==3.2.0) (3.0.4)\n","Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,<1.26,>=1.21.1 in /usr/local/lib/python3.7/dist-packages (from requests<3.0.0,>=2.13.0->spacy<3.3.0,>=3.2.0->en-core-web-trf==3.2.0) (1.24.3)\n","Requirement already satisfied: transformers<4.16.0,>=3.4.0 in /usr/local/lib/python3.7/dist-packages (from spacy-transformers<1.2.0,>=1.1.2->en-core-web-trf==3.2.0) (4.15.0)\n","Requirement already satisfied: spacy-alignments<1.0.0,>=0.7.2 in /usr/local/lib/python3.7/dist-packages (from spacy-transformers<1.2.0,>=1.1.2->en-core-web-trf==3.2.0) (0.8.4)\n","Requirement already satisfied: torch>=1.6.0 in /usr/local/lib/python3.7/dist-packages (from spacy-transformers<1.2.0,>=1.1.2->en-core-web-trf==3.2.0) (1.10.0+cu111)\n","Requirement already satisfied: sacremoses in /usr/local/lib/python3.7/dist-packages (from transformers<4.16.0,>=3.4.0->spacy-transformers<1.2.0,>=1.1.2->en-core-web-trf==3.2.0) (0.0.47)\n","Requirement already satisfied: huggingface-hub<1.0,>=0.1.0 in /usr/local/lib/python3.7/dist-packages (from transformers<4.16.0,>=3.4.0->spacy-transformers<1.2.0,>=1.1.2->en-core-web-trf==3.2.0) (0.4.0)\n","Requirement already satisfied: tokenizers<0.11,>=0.10.1 in /usr/local/lib/python3.7/dist-packages (from transformers<4.16.0,>=3.4.0->spacy-transformers<1.2.0,>=1.1.2->en-core-web-trf==3.2.0) (0.10.3)\n","Requirement already satisfied: importlib-metadata in /usr/local/lib/python3.7/dist-packages (from transformers<4.16.0,>=3.4.0->spacy-transformers<1.2.0,>=1.1.2->en-core-web-trf==3.2.0) (4.10.0)\n","Requirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.7/dist-packages (from transformers<4.16.0,>=3.4.0->spacy-transformers<1.2.0,>=1.1.2->en-core-web-trf==3.2.0) (6.0)\n","Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.7/dist-packages (from transformers<4.16.0,>=3.4.0->spacy-transformers<1.2.0,>=1.1.2->en-core-web-trf==3.2.0) (2019.12.20)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.7/dist-packages (from transformers<4.16.0,>=3.4.0->spacy-transformers<1.2.0,>=1.1.2->en-core-web-trf==3.2.0) (3.4.2)\n","Requirement already satisfied: click<9.0.0,>=7.1.1 in /usr/local/lib/python3.7/dist-packages (from typer<0.5.0,>=0.3.0->spacy<3.3.0,>=3.2.0->en-core-web-trf==3.2.0) (7.1.2)\n","Requirement already satisfied: MarkupSafe>=0.23 in /usr/local/lib/python3.7/dist-packages (from jinja2->spacy<3.3.0,>=3.2.0->en-core-web-trf==3.2.0) (2.0.1)\n","Requirement already satisfied: joblib in /usr/local/lib/python3.7/dist-packages (from sacremoses->transformers<4.16.0,>=3.4.0->spacy-transformers<1.2.0,>=1.1.2->en-core-web-trf==3.2.0) (1.1.0)\n","Requirement already satisfied: six in /usr/local/lib/python3.7/dist-packages (from sacremoses->transformers<4.16.0,>=3.4.0->spacy-transformers<1.2.0,>=1.1.2->en-core-web-trf==3.2.0) (1.15.0)\n","Installing collected packages: en-core-web-trf\n","Successfully installed en-core-web-trf-3.2.0\n","\u001b[38;5;2m✔ Download and installation successful\u001b[0m\n","You can now load the package via spacy.load('en_core_web_trf')\n"]}],"source":["!python -m spacy download en_core_web_trf"]},{"cell_type":"code","execution_count":10,"metadata":{"id":"Pe3arRRS_5Pa","executionInfo":{"status":"ok","timestamp":1642165216508,"user_tz":0,"elapsed":4680,"user":{"displayName":"Jake Rutherford","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"06919904590009580026"}}},"outputs":[],"source":["import en_core_web_trf\n","nlp = en_core_web_trf.load()"]},{"cell_type":"code","execution_count":32,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":69},"executionInfo":{"elapsed":220,"status":"ok","timestamp":1642165848098,"user":{"displayName":"Jake Rutherford","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"06919904590009580026"},"user_tz":0},"id":"7sKg06wQ4FQ2","outputId":"1a3a0481-9da8-46c9-f54f-c4945fc7c33e"},"outputs":[{"output_type":"stream","name":"stdout","text":["[('employee', 'PERSON'), ('start', 'EVENT')]\n"]},{"output_type":"display_data","data":{"text/html":["<span class=\"tex2jax_ignore\"><div class=\"entities\" style=\"line-height: 2.5; direction: ltr\">The employee should give you proof within \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    21 days\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n"," of the SMP start date .</div></span>"],"text/plain":["<IPython.core.display.HTML object>"]},"metadata":{}}],"source":["i = 50\n","doc = nlp(df.text[i])\n","print(df.labelled_entities[i])\n","displacy.render(doc, style=\"ent\", jupyter=True)"]},{"cell_type":"markdown","metadata":{"id":"W8IFfu4fS5bC"},"source":["This model finds the following named entities:\n","\n","Source https://spacy.io/models/en#en_core_web_trf"]},{"cell_type":"code","execution_count":12,"metadata":{"id":"YlsqrMrOFpIr","executionInfo":{"status":"ok","timestamp":1642165216879,"user_tz":0,"elapsed":13,"user":{"displayName":"Jake Rutherford","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"06919904590009580026"}}},"outputs":[],"source":["spacy_ents = {'CARDINAL', 'DATE', 'EVENT', 'FAC', 'GPE', 'LANGUAGE', 'LAW', 'LOC', 'MONEY', 'NORP', 'ORDINAL', 'ORG', 'PERCENT', 'PERSON', 'PRODUCT', 'QUANTITY', 'TIME', 'WORK_OF_ART'}"]},{"cell_type":"code","execution_count":13,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":14,"status":"ok","timestamp":1642165216880,"user":{"displayName":"Jake Rutherford","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"06919904590009580026"},"user_tz":0},"id":"4cRbtsAyJD_r","outputId":"6b8f78d5-7994-4aed-fc94-ecf61ae60801"},"outputs":[{"output_type":"stream","name":"stdout","text":["PERCENT :  Percentage, including \"%\"\n","LAW :  Named documents made into laws.\n","MONEY :  Monetary values, including unit\n","ORG :  Companies, agencies, institutions, etc.\n","DATE :  Absolute or relative dates or periods\n","ORDINAL :  \"first\", \"second\", etc.\n","PRODUCT :  Objects, vehicles, foods, etc. (not services)\n","EVENT :  Named hurricanes, battles, wars, sports events, etc.\n","TIME :  Times smaller than a day\n","QUANTITY :  Measurements, as of weight or distance\n","WORK_OF_ART :  Titles of books, songs, etc.\n","LANGUAGE :  Any named language\n","GPE :  Countries, cities, states\n","FAC :  Buildings, airports, highways, bridges, etc.\n","NORP :  Nationalities or religious or political groups\n","CARDINAL :  Numerals that do not fall under another type\n","PERSON :  People, including fictional\n","LOC :  Non-GPE locations, mountain ranges, bodies of water\n"]}],"source":["for ent in spacy_ents:\n","  print(ent, ': ', spacy.explain(ent))"]},{"cell_type":"markdown","metadata":{"id":"_OBzzECvWqI3"},"source":["By contrast, our schema is:\n","\n"]},{"cell_type":"code","execution_count":33,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":287,"status":"ok","timestamp":1642165884384,"user":{"displayName":"Jake Rutherford","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"06919904590009580026"},"user_tz":0},"id":"Tgb79yldXRks","outputId":"41b0012d-78b7-4345-ad20-dfcff16f97be"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["{'I-CONTACT',\n"," 'I-DATE',\n"," 'I-EVENT',\n"," 'I-FINANCE',\n"," 'I-FORM',\n"," 'I-LOCATION',\n"," 'I-MISC',\n"," 'I-ORGANIZATION',\n"," 'I-PERSON',\n"," 'I-STATE',\n"," 'O'}"]},"metadata":{},"execution_count":33}],"source":["{label for labels in df.label_list for label in labels}"]},{"cell_type":"markdown","metadata":{"id":"-nTzwxidXxjL"},"source":["Some of these map directly to the SpaCy schema. Some do not have an equivalent in the SpaCy schema. Where there is not a direct mapping, we will map to 'O'. The dictionaries below create a common interface between the SpaCy schema and the govNER schema."]},{"cell_type":"code","execution_count":34,"metadata":{"id":"ZULSkDGBYOVQ","executionInfo":{"status":"ok","timestamp":1642165910842,"user_tz":0,"elapsed":193,"user":{"displayName":"Jake Rutherford","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"06919904590009580026"}}},"outputs":[],"source":["spacy2gov = {\n","    'CARDINAL': 'O',\n","    'DATE': 'DATE',\n","    'EVENT': 'EVENT',\n","    'FAC': 'LOCATION',\n","    'GPE': 'LOCATION',\n","    'LANGUAGE': 'MISC',\n","    'LAW': 'MISC',\n","    'LOC': 'LOCATION',\n","    'MONEY': 'FINANCE',\n","    'NORP': 'MISC',\n","    'ORDINAL': 'O',\n","    'ORG': 'ORGANIZATION',\n","    'PERCENT': 'O',\n","    'PERSON': 'PERSON',\n","    'PRODUCT': 'MISC',\n","    'QUANTITY': 'O',\n","    'TIME': 'DATE',\n","    'WORK_OF_ART': 'O',\n","    'O': 'O'\n","}\n","\n","gov2spacy = {\n","    'CONTACT': 'O',\n","    'DATE': 'DATE',\n","    'EVENT': 'EVENT',\n","    'FINANCE': 'FINANCE',\n","    'FORM': 'O',\n","    'LOCATION': 'LOCATION',\n","    'MISC': 'MISC',\n","    'ORGANIZATION': 'ORGANIZATION',\n","    'PERSON': 'PERSON',\n","    'STATE': 'O',\n","    'O': 'O'\n"," }\n"]},{"cell_type":"code","source":["# add a column with labels that are consistent with the outputs from SpaCy NER\n","df['labels_mapped_2_spacy'] = df.labels.apply(lambda x: [[y[0], y[1], gov2spacy[y[2]]] for y in x])"],"metadata":{"id":"DHD4bwxvgnUP","executionInfo":{"status":"ok","timestamp":1642165961471,"user_tz":0,"elapsed":211,"user":{"displayName":"Jake Rutherford","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"06919904590009580026"}}},"execution_count":35,"outputs":[]},{"cell_type":"markdown","source":["### Label inference"],"metadata":{"id":"XAO8lu6LD7ZC"}},{"cell_type":"code","source":["# get the data into the right format for SpaCy:\n","# data = [[sentence_1, {'entities': [[start_char_1, end_char_1, label_1],...,[start_char_n, end_char_n, label_n]]}],...]\n","data = list(zip(df.text, df.labels_mapped_2_spacy.apply(lambda x: {'entities': x})))\n","data[2]"],"metadata":{"id":"TWt-qqUjYd-9","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1642167027788,"user_tz":0,"elapsed":196,"user":{"displayName":"Jake Rutherford","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"06919904590009580026"}},"outputId":"d5b11ab1-50a6-4829-a0bc-14b0da9a2cf8"},"execution_count":66,"outputs":[{"output_type":"execute_result","data":{"text/plain":["('Pay the court fee Pay by credit or debit card if you ’ re making a claim online .',\n"," {'entities': [[8, 17, 'FINANCE'], [25, 45, 'FINANCE'], [67, 79, 'O']]})"]},"metadata":{},"execution_count":66}]},{"cell_type":"code","source":["# some entities get mapped to 'O' (see output above), so we need to remove those\n","data = [(d[0], {'entities': [ent for ent in d[1]['entities'] if ent[-1] != 'O']}) for d in data]\n","data[2]"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"S6BgRi7bvoKA","executionInfo":{"status":"ok","timestamp":1642167029722,"user_tz":0,"elapsed":198,"user":{"displayName":"Jake Rutherford","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"06919904590009580026"}},"outputId":"9cce5dda-182d-44ed-d6a4-3492936b2900"},"execution_count":67,"outputs":[{"output_type":"execute_result","data":{"text/plain":["('Pay the court fee Pay by credit or debit card if you ’ re making a claim online .',\n"," {'entities': [[8, 17, 'FINANCE'], [25, 45, 'FINANCE']]})"]},"metadata":{},"execution_count":67}]},{"cell_type":"code","source":["examples = []\n","scorer = Scorer()\n","\n","for text, annotations in tqdm(data):\n","    doc = nlp.make_doc(text)\n","    try:\n","      example = Example.from_dict(doc, annotations)\n","      example.predicted = nlp(example.predicted)\n","    except:\n","      continue\n","    \n","    ents = list(example.predicted.ents)\n","    ents = [Span(example.predicted, ent.start, ent.end, label=spacy2gov[ent.label_]) for ent in ents if spacy2gov[ent.label_] != 'O']\n","\n","    example.predicted.ents = ents\n","\n","    examples.append(example)\n","\n","scores = scorer.score(examples)"],"metadata":{"id":"AFTNeM4qYaB4"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["pd.DataFrame(scores['ents_per_type'])"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":143},"id":"s_wpaVPc15Oo","executionInfo":{"status":"ok","timestamp":1642169404909,"user_tz":0,"elapsed":199,"user":{"displayName":"Jake Rutherford","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"06919904590009580026"}},"outputId":"a55ce562-f34c-42a7-8d2c-323f7f65f71f"},"execution_count":100,"outputs":[{"output_type":"execute_result","data":{"text/html":["\n","  <div id=\"df-30f40822-0b68-40a6-b469-7386a2d409bd\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>ORGANIZATION</th>\n","      <th>PERSON</th>\n","      <th>FINANCE</th>\n","      <th>LOCATION</th>\n","      <th>EVENT</th>\n","      <th>DATE</th>\n","      <th>MISC</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>p</th>\n","      <td>0.498182</td>\n","      <td>0.125000</td>\n","      <td>0.0</td>\n","      <td>0.758621</td>\n","      <td>0.0</td>\n","      <td>0.278481</td>\n","      <td>0.038462</td>\n","    </tr>\n","    <tr>\n","      <th>r</th>\n","      <td>0.259962</td>\n","      <td>0.002208</td>\n","      <td>0.0</td>\n","      <td>0.483516</td>\n","      <td>0.0</td>\n","      <td>0.360656</td>\n","      <td>0.013889</td>\n","    </tr>\n","    <tr>\n","      <th>f</th>\n","      <td>0.341646</td>\n","      <td>0.004338</td>\n","      <td>0.0</td>\n","      <td>0.590604</td>\n","      <td>0.0</td>\n","      <td>0.314286</td>\n","      <td>0.020408</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-30f40822-0b68-40a6-b469-7386a2d409bd')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-30f40822-0b68-40a6-b469-7386a2d409bd button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-30f40822-0b68-40a6-b469-7386a2d409bd');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "],"text/plain":["   ORGANIZATION    PERSON  FINANCE  LOCATION  EVENT      DATE      MISC\n","p      0.498182  0.125000      0.0  0.758621    0.0  0.278481  0.038462\n","r      0.259962  0.002208      0.0  0.483516    0.0  0.360656  0.013889\n","f      0.341646  0.004338      0.0  0.590604    0.0  0.314286  0.020408"]},"metadata":{},"execution_count":100}]},{"cell_type":"markdown","source":["### Testing on gov.uk pages"],"metadata":{"id":"uF2_V-ux7kah"}},{"cell_type":"code","source":["def get_page_text(url):\n","  page = requests.get(url)\n","  soup = BeautifulSoup(page.content, \"html.parser\")\n","  body = soup.findAll(attrs={\"class\":\"gem-c-govspeak\"})\n","  text = ' '.join([i.text.replace('\\n', ' ').strip() for i in body])\n","  return text"],"metadata":{"id":"rNnw0x7QSqvQ","executionInfo":{"status":"ok","timestamp":1642170050998,"user_tz":0,"elapsed":221,"user":{"displayName":"Jake Rutherford","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"06919904590009580026"}}},"execution_count":117,"outputs":[]},{"cell_type":"code","source":["pages = ['/student-visa', \n","         '/marriage-visa', \n","         '/marriage-visa/eligibility', \n","         '/marriage-visa/documents-you-will-need', \n","         '/marriage-visa/apply', \n","         '/guidance/covid-19-coronavirus-restrictions-what-you-can-and-cannot-do#what-has-changed',\n","         ]"],"metadata":{"id":"iB7tJMja8epX","executionInfo":{"status":"ok","timestamp":1642170305878,"user_tz":0,"elapsed":233,"user":{"displayName":"Jake Rutherford","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"06919904590009580026"}}},"execution_count":123,"outputs":[]},{"cell_type":"code","source":["for page in pages:\n","  print('****', page, '****')\n","  doc = nlp(get_page_text('https://www.gov.uk/' + page))\n","  displacy.render(doc, style=\"ent\", jupyter=True)\n","  print('**********************\\n\\n')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"id":"He9fXlZA95MO","executionInfo":{"status":"ok","timestamp":1642170453777,"user_tz":0,"elapsed":38017,"user":{"displayName":"Jake Rutherford","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"06919904590009580026"}},"outputId":"bcb8a40e-d3af-404b-8ee3-f5962521d5e3"},"execution_count":127,"outputs":[{"output_type":"stream","name":"stdout","text":["**** /student-visa ****\n"]},{"output_type":"display_data","data":{"text/html":["<span class=\"tex2jax_ignore\"><div class=\"entities\" style=\"line-height: 2.5; direction: ltr\">You can apply for a Student visa to study in the \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    UK\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n"," if you’re \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    16\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n"," or over and you:  have been offered a place on a course by a licensed student sponsor  have enough money to support yourself and pay for your course - the amount will vary depending on your circumstances can speak, read, write and understand \n","<mark class=\"entity\" style=\"background: #ff8197; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    English\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">LANGUAGE</span>\n","</mark>\n","  have consent from your parents if you’re \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    16\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n"," or \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    17\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n"," - you’ll need evidence of this when you apply   If you’re \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    16\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n"," or \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    17\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n"," and you want to study at an independent school in the \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    UK\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n",", you may be eligible for a Child Student visa instead.  This visa has replaced the Tier \n","<mark class=\"entity\" style=\"background: #e4e7d2; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    4\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">CARDINAL</span>\n","</mark>\n"," (General) student visa. If you or your family are from the \n","<mark class=\"entity\" style=\"background: #7aecec; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    EU\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">ORG</span>\n","</mark>\n",", \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    Switzerland\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n",", \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    Norway\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n",", \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    Iceland\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n"," or \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    Liechtenstein\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n"," If you or your family member started living in the \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    UK\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n"," by \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    31 December 2020\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n",", you may be able to apply to the free \n","<mark class=\"entity\" style=\"background: #7aecec; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    EU Settlement Scheme\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">ORG</span>\n","</mark>\n",". The deadline to apply was \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    30 June 2021\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n"," for most people. You can still apply if either:   you have a later deadline - for example, you’re joining a family member in the \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    UK\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n","   you have ‘reasonable grounds’ for being unable to apply by \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    30 June 2021\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n"," - for example, you had an illness or were the victim of domestic abuse   Check if you can still apply to the EU Settlement Scheme. When to apply When you can apply depends on whether you’re applying from inside or outside the \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    UK\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n",". Applying from outside the \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    UK\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n"," The earliest you can apply for a visa is \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    6 months\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n"," before you start your course. You’ll usually get a decision on your visa within \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    3 weeks\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n",". Applying from inside the \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    UK\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n"," The earliest you can apply is \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    3 months\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n"," before your course starts. You must apply before your current visa expires. Your new course must begin within \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    28 days\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n"," of your current visa expiring. You’ll usually get a decision within \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    8 weeks\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n",". How long you can stay How long you can stay depends on the length of your course and what study you’ve already completed in the \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    UK\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n",". If you’re \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    18\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n"," or over and your course is at degree level, you can usually stay in the \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    UK\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n"," for \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    up to 5 years\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n",". If it’s below degree level, you can usually stay in the \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    UK\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n"," for \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    up to 2 years\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n",". Read the guidance to find out exactly how long you can stay. Staying longer in the \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    UK\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n"," You may be able to:   extend your visa if you’re eligible, for example to continue your studies in the \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    UK\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n","  switch to a Student visa from another visa if you’re already in the \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    UK\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n","  switch to a Graduate visa to stay in the \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    UK\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n"," for \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    at least 2 years\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n"," after successfully completing your course  When you can travel to the \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    UK\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n"," You can arrive before your course starts. This can be either:  \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    up to 1 week before\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n",", if your course lasts \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    6 months or less\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n"," \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    up to 1 month before\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n",", if your course lasts \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    more than 6 months\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n","  You must not travel to the \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    UK\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n"," before the start date given on your visa, no matter when your course starts. Fees It costs:  £\n","<mark class=\"entity\" style=\"background: #e4e7d2; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    348\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">MONEY</span>\n","</mark>\n"," to apply for a Student visa from outside the \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    UK\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n"," £\n","<mark class=\"entity\" style=\"background: #e4e7d2; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    475\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">MONEY</span>\n","</mark>\n"," to extend or switch to a Student visa from inside the \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    UK\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n","  You must pay the visa fee for each person that joins you. Healthcare surcharge You’ll also have to pay the healthcare surcharge as part of your application. How much you pay depends on how long your visa lasts. Check how much you’ll have to pay before you apply. Your partner and children You may be able to bring your partner and children (‘dependants’). What you can and cannot do You can:  study work as a student union sabbatical officer  You may be able to work - how much depends on what you’re studying and whether you’re working in or out of term-time. You cannot:  claim public funds (benefits) and pensions work in certain jobs, for example as a professional sportsperson or sports coach be self-employed study at an academy or a local authority-funded school (also known as a maintained school)  If your application is successful, you’ll be told what you can and cannot do on a Student visa.</div></span>"],"text/plain":["<IPython.core.display.HTML object>"]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["**********************\n","\n","\n","**** /marriage-visa ****\n"]},{"output_type":"display_data","data":{"text/html":["<span class=\"tex2jax_ignore\"><div class=\"entities\" style=\"line-height: 2.5; direction: ltr\">You must apply for a Marriage Visitor visa if:  you want to get married or register a civil partnership in the \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    UK\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n"," you want to give notice of a marriage or civil partnership in \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    UK\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n"," you’re not planning to stay or settle in the \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    UK\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n"," after your marriage or civil partnership you meet the other eligibility requirements   You do not need a Marriage Visitor visa to convert your civil partnership into a marriage - you can apply for a Standard Visitor visa. You also do not need a Marriage Visitor visa if \n","<mark class=\"entity\" style=\"background: #e4e7d2; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    one\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">CARDINAL</span>\n","</mark>\n"," of the following is true:  you have settled or pre-settled status under the EU Settlement Scheme you have applied to the EU Settlement Scheme, and have not got a decision yet you’re an \n","<mark class=\"entity\" style=\"background: #c887fb; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    Irish\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">NORP</span>\n","</mark>\n"," citizen   You cannot apply if you qualify for \n","<mark class=\"entity\" style=\"background: #c887fb; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    British\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">NORP</span>\n","</mark>\n"," citizenship - including if you can have dual nationality. You must apply for \n","<mark class=\"entity\" style=\"background: #c887fb; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    British\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">NORP</span>\n","</mark>\n"," citizenship instead.  What you can and cannot do You can:  marry or enter into a civil partnership in the \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    UK\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n"," within \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    6 months\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n"," of your arrival - you must use a venue licensed for this purpose pass through the \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    UK\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n"," in transit (on your way to another country)  You cannot:  get public funds (benefits) bring in family members (‘dependants’) - they must apply separately live in the \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    UK\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n"," for extended periods through frequent visits extend your visa or switch to another visa work - except for permitted activities related to your work or business overseas, such as attending meetings study  You can read detailed guidance about what you can and cannot do with a Marriage Visitor visa. How long you can stay You can use this visa to visit the \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    UK\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n"," for \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    up to 6 months\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n",". When to apply and how long it takes If you need a visa, you must apply online before you come to the \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    UK\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n",". As part of your application, you’ll need to book an appointment at a visa application centre to prove your identity and provide your documents. Allow time to attend your appointment, as the visa application centre could be in another country. The visa application centre may keep your passport and documents while processing your  application. The earliest you can apply is \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    3 months\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n"," before you travel. Getting a decision Once you’ve applied online, proved your identity and provided your documents, you’ll usually get a decision on your visa within \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    3 weeks\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n",". Find out how to get your visa decision faster - this depends on what country you’re in. Fees It costs £\n","<mark class=\"entity\" style=\"background: #e4e7d2; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    95\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">MONEY</span>\n","</mark>\n"," to apply.</div></span>"],"text/plain":["<IPython.core.display.HTML object>"]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["**********************\n","\n","\n","**** /marriage-visa/eligibility ****\n"]},{"output_type":"display_data","data":{"text/html":["<span class=\"tex2jax_ignore\"><div class=\"entities\" style=\"line-height: 2.5; direction: ltr\">You must prove that:  you’re \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    18\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n"," or over you’re free to give notice of marriage, to marry or enter into a civil partnership in the \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    UK\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n"," within 6 months of your arrival you’re in a genuine relationship you’re visiting the \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    UK\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n"," for less than 6 months you’ll leave the \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    UK\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n"," at the end of your visit you’ll not live in the \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    UK\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n"," for extended periods through frequent or successive visits, or make the \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    UK\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n"," your main home you’re able to support yourself during your trip (or have funding from someone else to support you) you’re able to pay for your return or onward journey (or have funding from someone else to pay for the journey) you have proof of any other activities you want to do in the \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    UK\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n",", as allowed by \n","<mark class=\"entity\" style=\"background: #ff8197; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    the Visitor Rules\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">LAW</span>\n","</mark>\n","</div></span>"],"text/plain":["<IPython.core.display.HTML object>"]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["**********************\n","\n","\n","**** /marriage-visa/documents-you-will-need ****\n"]},{"output_type":"display_data","data":{"text/html":["<span class=\"tex2jax_ignore\"><div class=\"entities\" style=\"line-height: 2.5; direction: ltr\">You must provide a passport or travel document. Your passport should be valid for the whole of your stay in the \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    UK\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n"," and contain a blank page for your visa. You can supply the following to support your application:  details of the marriage or civil partnership and proof that you’ve paid money for some of its costs proof that you’re planning to get married in the \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    UK\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n",", for example a booking confirmation or emails between you and the venue  See the full list of documents you can provide to prove your eligibility. You’ll need to provide a certified translation of any documents that are not in \n","<mark class=\"entity\" style=\"background: #ff8197; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    English\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">LANGUAGE</span>\n","</mark>\n"," or \n","<mark class=\"entity\" style=\"background: #ff8197; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    Welsh\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">LANGUAGE</span>\n","</mark>\n",". If you’ve been married before You’ll need to show proof that you’re free to marry or enter into a civil partnership again, for example a:  decree absolute death certificate of a previous partner   You may need to provide additional documents depending on your circumstances.</div></span>"],"text/plain":["<IPython.core.display.HTML object>"]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["**********************\n","\n","\n","**** /marriage-visa/apply ****\n"]},{"output_type":"display_data","data":{"text/html":["<span class=\"tex2jax_ignore\"><div class=\"entities\" style=\"line-height: 2.5; direction: ltr\">If you need a visa, you must apply online before you travel to the \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    UK\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n",". Check what documents you’ll need to apply. Proving your identity and providing supporting documents As part of your online application, you need to book an appointment at a visa application centre. You’ll have your fingerprints and photograph (known as ‘biometric information’) taken at your appointment. Allow time to attend your appointment, as the visa application centre could be in another country. The visa application centre may keep your passport and documents while processing your application. Apply for a Marriage Visitor visa Once you’ve started your application you can save your form and complete it later.  Apply now  Continue your application You can sign back into your application if you’ve saved it. Check your email and follow the link to return to your application. Apply with family members Your partner must apply for their own Marriage Visitor visa and pay the fee if you both need one. Your child will need to apply as a standard visitor if they need a visa. You can apply on behalf of your partner and child, if they cannot apply for themselves. They must attend their own appointment at a visa application centre. How long it takes to get a decision Once you’ve applied online, proved your identity and provided your documents, you’ll usually get a decision on your visa within \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    3 weeks\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n",". Find out how to get your visa decision faster - this depends on what country you’re in. You’ll get an email or a letter containing the decision on your application. This will explain what you need to do next. If you need to change or cancel your application If you need to change something in your application after you’ve sent it contact \n","<mark class=\"entity\" style=\"background: #7aecec; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    UK Visas and Immigration\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">ORG</span>\n","</mark>\n"," (\n","<mark class=\"entity\" style=\"background: #7aecec; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    UKVI\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">ORG</span>\n","</mark>\n","). You can ask to cancel your application. You’ll only get your fee refunded if the application has not been processed yet.</div></span>"],"text/plain":["<IPython.core.display.HTML object>"]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["**********************\n","\n","\n","**** /guidance/covid-19-coronavirus-restrictions-what-you-can-and-cannot-do#what-has-changed ****\n"]},{"output_type":"display_data","data":{"text/html":["<span class=\"tex2jax_ignore\"><div class=\"entities\" style=\"line-height: 2.5; direction: ltr\">What has changed The government has announced that \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    England\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n"," has moved to Plan B in response to the risks of the \n","<mark class=\"entity\" style=\"background: #bfeeb7; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    Omicron\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">PRODUCT</span>\n","</mark>\n"," variant. This means:  Face coverings are required by law in most indoor settings. Office workers who can work from home should do so. Certain venues and events will be required by law to check that all visitors aged \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    18 years or over\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n"," are fully vaccinated, have proof of a negative test in \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    the last 48 hours\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">TIME</span>\n","</mark>\n",", or have an exemption.   COVID-19 remains a risk It is still possible to catch and spread COVID-19, even if you are fully vaccinated. Anyone with COVID-19 symptoms or a positive test result should stay at home and self-isolate immediately. If you have symptoms of COVID-19, you should arrange to take a PCR test as soon as possible, even if you’ve had \n","<mark class=\"entity\" style=\"background: #e4e7d2; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    one\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">CARDINAL</span>\n","</mark>\n"," or more doses of a COVID-19 vaccine. COVID-19 will be a feature of our lives for the foreseeable future, so we need to learn to live with it and manage the risk to ourselves and others. All of us can play our part by understanding the situations where risks of COVID-19 infection and transmission are likely to be higher, and taking action to reduce these risks. Following this guidance will help you to understand situations where there is a greater risk of catching or spreading COVID-19 and the steps that you can take to stay safe and protect others. Every action you can take to help reduce the spread will help reduce pressure on the \n","<mark class=\"entity\" style=\"background: #7aecec; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    NHS\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">ORG</span>\n","</mark>\n"," during \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    the winter months\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n",". Understanding the risks of COVID-19 The risk of catching or passing on COVID-19 can be higher in certain places and when doing certain activities. COVID-19 is spread by airborne transmission, close contact via droplets, and via surfaces. Airborne transmission is a very significant way that the virus circulates. It is possible to be infected by someone you don’t have close contact with, especially if you’re in a crowded and/or poorly ventilated space. Close contact with an infected person is also a significant way COVID-19 is spread. When someone with COVID-19 breathes, speaks, coughs or sneezes, they release particles containing the virus that causes COVID-19. The particles can come into contact with the eyes, nose or mouth or can be breathed in by another person. The particles can also land on surfaces and be passed from person to person via touch. In general, the risk of catching or passing on COVID-19 is higher in crowded and enclosed spaces, where there are more people who might be infectious and limited fresh air. In situations where there is a higher risk of catching or passing on COVID-19, you should be particularly careful to follow the guidance on keeping yourself and others safe. Every little action helps to keep us all safer. Keeping yourself and others safe There are still cases of COVID-19 in \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    England\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n"," and there is a risk you could catch or pass on the virus, even once you are fully vaccinated. This means it is important that you understand and consider the risks of catching or spreading COVID-19 in all situations. While no situation is risk free, there are easy and effective actions you can take to protect yourself and others around you. If you are worried about going back to a more ‘normal’ life, there is information from the \n","<mark class=\"entity\" style=\"background: #7aecec; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    NHS\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">ORG</span>\n","</mark>\n"," on how to cope with anxiety about lockdown lifting. Get vaccinated All adults in \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    England\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n"," have now been offered \n","<mark class=\"entity\" style=\"background: #e4e7d2; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    at least 2\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">CARDINAL</span>\n","</mark>\n"," doses of a COVID-19 vaccine. The vaccines are safe and effective. Getting fully vaccinated is the best way of protecting you and others against COVID-19. If you have not yet received the COVID-19 vaccine, you should get vaccinated. Evidence indicates that \n","<mark class=\"entity\" style=\"background: #e4e7d2; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    2\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">CARDINAL</span>\n","</mark>\n"," doses of a COVID-19 vaccine provide very effective protection against hospitalisation. It usually takes around 2 to 3 weeks for your body to develop its protective response. To maintain this high level of protection through \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    the coming winter\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n",", you should also get a booster vaccine for COVID-19 when offered. \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    Winter\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n"," is a difficult time when our immunity is weaker. Getting the booster vaccine is an essential part of ensuring immune defence \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    this season\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n",". However, even if you have been fully vaccinated, you could still get COVID-19 and pass it on to others. Whilst the vaccines provide a high level of protection against severe disease, hospitalisation and death, a recent \n","<mark class=\"entity\" style=\"background: #7aecec; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    UKHSA\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">ORG</span>\n","</mark>\n"," report shows that \n","<mark class=\"entity\" style=\"background: #e4e7d2; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    around 1\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">CARDINAL</span>\n","</mark>\n"," in \n","<mark class=\"entity\" style=\"background: #e4e7d2; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    5\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">CARDINAL</span>\n","</mark>\n"," people who have had both doses are still vulnerable to getting infected with the \n","<mark class=\"entity\" style=\"background: #bfeeb7; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    Delta\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">PRODUCT</span>\n","</mark>\n"," variant and showing symptoms. You can also still spread COVID-19 to others. We all need to do what we can to reduce the spread of COVID-19 to protect others and to reduce the risk of new variants developing and spreading. Following the advice in this guidance will help you to protect your friends, family, and communities, including those who have been vaccinated. Get tested and self-isolate if required If you have symptoms or test positive If you develop COVID-19 symptoms, self-isolate immediately and get a PCR test, even if your symptoms are mild. This is because many people experience mild symptoms from COVID-19, but may still pass on the virus to others. The most important symptoms of COVID-19 are recent onset of any of the following:  a new continuous cough a high temperature a loss of, or change in, your normal sense of taste or smell  You should self-isolate at home while you get a PCR test and wait for the results. You must self-isolate if you test positive. You must self-isolate from \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    the day\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n"," your symptoms started and \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    the next 10 full days\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n",", or from \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    the day\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n"," your test was taken if you do not have symptoms and \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    the next 10 full days\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n",". This is the law, regardless of whether you have been vaccinated. Self-isolating is important because you could pass the infection on to others, even if you do not have symptoms. You must isolate for the full amount of time you are told to, because this is the period when the virus is most likely to be passed on to others. You may be able to end your self-isolation period before the end of \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    the 10 full days\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n",". You can take a \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    daily\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n"," LFD test from \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    the sixth day\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n"," of your isolation period, and another LFD test on \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    the following day\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n",". The \n","<mark class=\"entity\" style=\"background: #e4e7d2; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    second\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">ORDINAL</span>\n","</mark>\n"," LFD test should be taken at least 24 hours later. If both these test results are negative, and you do not have a high temperature, you may end your self-isolation after the \n","<mark class=\"entity\" style=\"background: #e4e7d2; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    second\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">ORDINAL</span>\n","</mark>\n"," negative test result. You should not take an LFD test before \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    the sixth day\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n"," of your isolation period, and you should only end your self-isolation following \n","<mark class=\"entity\" style=\"background: #e4e7d2; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    2\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">CARDINAL</span>\n","</mark>\n"," consecutive negative LFD tests which should be taken \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    at least 24 hours\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">TIME</span>\n","</mark>\n"," apart. If you have received a positive rapid lateral flow test result but do not have any of the main symptoms of COVID-19, you should report your result and self-isolate. You do not need to take a follow-up PCR test unless:  you wish to claim the Test and Trace Support Payment  you have a health condition that means you may be suitable for new COVID-19 treatments you are taking rapid lateral flow tests as part of research or surveillance programmes, and the programme asks you to do so you are an international arrival and have a positive day \n","<mark class=\"entity\" style=\"background: #e4e7d2; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    2\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">CARDINAL</span>\n","</mark>\n"," rapid lateral flow test  If you are told to self-isolate by NHS Test and Trace You must also self-isolate if you are told to do so by NHS Test and Trace. Find out:  what you should do if you live in the same household as someone who has tested positive what you should do if you’ve come into contact with someone outside your household who has tested positive  Guidance on self-isolating When self-isolating, follow the:  stay at home guidance for people with suspected or confirmed COVID-19 stay at home guidance for non-household contacts of people with confirmed COVID-19  This will help reduce the risk of spreading COVID-19 to other members of your household and community. In both cases you must isolate at all times and not have contact with other people. There are only very limited circumstances when you do not have to do this, such as seeking medical assistance. If you do leave your home during your period of self-isolation for a permitted reason, you should maintain social distancing, keep \n","<mark class=\"entity\" style=\"background: #e4e7d2; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    2 metres\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">QUANTITY</span>\n","</mark>\n"," apart from other people, and wear a face covering where possible. You may be entitled to a one-off payment of £\n","<mark class=\"entity\" style=\"background: #e4e7d2; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    500\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">MONEY</span>\n","</mark>\n"," through the \n","<mark class=\"entity\" style=\"background: #7aecec; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    NHS\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">ORG</span>\n","</mark>\n"," Test and Trace Support Payment scheme if you are required to stay at home and self-isolate, or you are the parent or guardian of a child who has been told to self-isolate. You should visit your local authority website for information on Test and Trace Support Payments and other practical support offered in your area including help accessing food. If you require prescription medication there is a medicine delivery service available through pharmacies and dispensing GPs. You could be fined if you do not self-isolate after being told to by \n","<mark class=\"entity\" style=\"background: #7aecec; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    NHS Test and Trace\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">ORG</span>\n","</mark>\n",". Self-isolation exemptions You’re not required to self-isolate if you live in the same household as someone with COVID-19, or are a close contact of someone with COVID-19, and any of the following apply:  you’re fully vaccinated you’re below the age of 18 years and \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    6 months\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n"," you’ve taken part in or are currently part of an approved COVID-19 vaccine trial you’re not able to get vaccinated for medical reasons  If you are aged 5 years and over and have been identified as a contact of someone with COVID-19, and you are not legally required to self-isolate, you are now strongly advised to:  take a lateral flow test every day for \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    7 days\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n"," take this \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    daily\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n"," lateral flow test before you leave your home for the first time that day  If any of these lateral flow tests are positive, you should immediately self-isolate in order to protect other people. \n","<mark class=\"entity\" style=\"background: #7aecec; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    NHS Test and Trace\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">ORG</span>\n","</mark>\n"," will contact you to let you know that you have been identified as a contact and check whether you are legally required to self-isolate. If you have previously received a positive COVID-19 PCR test result, you are not usually advised to be re-tested within \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    90 days\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n"," of this result. However, you should have a PCR test within \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    90 days\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n"," of a previous positive PCR test if you develop any new symptoms of COVID-19 or you are required to take a PCR test upon entry into the \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    UK\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n",". If you are tested within \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    90 days\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n"," of a positive PCR test result for either of these reasons, and the PCR test result is positive, you must self-isolate and follow the stay at home guidance. You can find further guidance for household contacts and guidance for non-household contacts of people with confirmed COVID-19 infections. Let fresh air in if you meet indoors. Meeting outdoors is safer When a person infected with COVID-19 coughs, talks or breathes, they release droplets and aerosols which can be breathed in by another person. Meeting outdoors vastly reduces the risk of airborne transmission, but this may not always be possible. If you’re indoors, you should let fresh air in to reduce the risk of catching or spreading COVID-19. The more fresh air you let into your home or other enclosed spaces, the less likely a person is to inhale infectious particles. You can let in fresh air by uncovering vents and opening doors and windows. Opening your windows for \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    just 10 minutes\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">TIME</span>\n","</mark>\n",", or a small amount of time continuously where you can, makes a significant difference. This is particularly important before, during, and after meeting people you do not live with indoors. Do not prop fire doors open. If you have an extractor fan at home, for example in your bathroom or kitchen, think about leaving it running for longer than usual with the door closed after someone has used the room. If you are concerned about the costs of heating, opening windows for shorter periods of time can still help to reduce the risk of the virus spreading. Wearing extra layers can help you to keep warm. You may be able to change the layout of your room so that you do not sit close to cold draughts from open windows or doors. There is guidance for the public on how to ventilate indoor spaces to stop the spread of COVID-19, including if someone is self isolating. This includes advice on how to claim financial and practical help on heating your home. Wear a face covering ​​ From \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    10 December\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n",", face coverings will be required by law in most indoor public places and on public transport, including taxis. See a full list of places where you must wear a face covering. There are some exemptions. You do not have to wear a face covering in hospitality settings such as cafés, restaurants and pubs. This is because it is not practical to keep removing face coverings to eat or drink. You do not need to wear a face covering in nightclubs or certain other night-time venues, including dance halls and discotheques. This is because it is not recommended that you wear a face covering while exercising or during strenuous physical activity, including dancing. Settings which are exempt from wearing a face covering include:  Restaurants, cafés and canteens Bars and shisha bars Gyms &amp; exercise facilities Photography studios Nightclubs, dance halls and discotheques  In indoor settings where a face covering is not legally required, you should still continue to wear a face covering in crowded and enclosed spaces where you may come into contact with other people you do not normally meet. Work from home if you can Office workers who can work from home should do so from \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    Monday 13 December\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n",". Anyone who cannot work from home should continue to go into work - for example, to access equipment necessary for their role or where their role must be completed in person. In-person working will be necessary in some cases to continue the effective and accessible delivery of some public services and private industries. If you need to continue to go into work, consider taking lateral flow tests regularly to manage your own risk and the risk to others. Employers should consider whether home working is appropriate for workers facing mental or physical health difficulties, or those with a particularly challenging home working environment. For those who attend their workplace, the Government will continue to provide up-to-date Working Safely guidance on how employers can reduce the risks in their workplace. Businesses should consider this guidance when preparing their health and safety risk assessments, and put in place suitable mitigations. Required use of the \n","<mark class=\"entity\" style=\"background: #7aecec; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    NHS\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">ORG</span>\n","</mark>\n"," \n","<mark class=\"entity\" style=\"background: #bfeeb7; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    COVID Pass\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">PRODUCT</span>\n","</mark>\n"," From \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    15 December\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n",", certain venues and events will be required by law to check that all visitors aged \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    18 years or over\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n"," are fully vaccinated (currently a full course of vaccination without the need for a booster, but this will be kept under review), have proof of a negative test in \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    the last 48 hours\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">TIME</span>\n","</mark>\n",", or that they have an exemption. This means that those aged \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    18 years or over\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n"," must show their \n","<mark class=\"entity\" style=\"background: #7aecec; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    NHS\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">ORG</span>\n","</mark>\n"," COVID Pass, or an alternative proof of a negative test result, such as an NHS Test and Trace email or text proof, to gain entry into these venues. You can access your NHS COVID Pass through:  the NHS App  NHS.UK A letter that you can obtain on NHS.UK or by calling 119  \n","<mark class=\"entity\" style=\"background: #bfeeb7; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    The NHS COVID Pass\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">PRODUCT</span>\n","</mark>\n"," lets you share your COVID vaccination status and test results in a secure way for entry to domestic venues or events. You can obtain \n","<mark class=\"entity\" style=\"background: #bfeeb7; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    an NHS COVID Pass\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">PRODUCT</span>\n","</mark>\n"," \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    two weeks\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n"," after completing a full course of vaccination or with a negative test in \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    the last 48 hours\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">TIME</span>\n","</mark>\n",". To strengthen the protection testing provides you are strongly advised to take tests as late as possible before attending the event, ideally within \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    12 hours\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">TIME</span>\n","</mark>\n",". \n","<mark class=\"entity\" style=\"background: #bfeeb7; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    The NHS COVID Pass\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">PRODUCT</span>\n","</mark>\n"," can be obtained with \n","<mark class=\"entity\" style=\"background: #e4e7d2; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    two\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">CARDINAL</span>\n","</mark>\n"," doses (or \n","<mark class=\"entity\" style=\"background: #e4e7d2; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    one\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">CARDINAL</span>\n","</mark>\n"," of the single-dose \n","<mark class=\"entity\" style=\"background: #7aecec; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    Janssen\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">ORG</span>\n","</mark>\n"," vaccine), but we will keep this under review as boosters are rolled out. You can also obtain \n","<mark class=\"entity\" style=\"background: #bfeeb7; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    an NHS COVID Pass\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">PRODUCT</span>\n","</mark>\n"," if:  you have received a trial vaccine as part of a formally approved COVID-19 vaccine trial in the \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    UK\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n"," you have a medical reason that means you cannot be vaccinated or tested, confirmed by your GP or a specialist clinician  You can also show email or text proof of your negative test result in order to gain entry to these venues. The use of the NHS COVID Pass is required as a condition of entry into the following places:   nightclubs, dancehalls and discotheques;  other \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    late night\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">TIME</span>\n","</mark>\n"," dance venues. These are any other venues that are: open \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    between 1am and 5am\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">TIME</span>\n","</mark>\n","; serve alcohol during this time; have a dancefloor (or designated space for dancing); and  provide music, whether live or recorded, for dancing.  indoor events with \n","<mark class=\"entity\" style=\"background: #e4e7d2; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    500\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">CARDINAL</span>\n","</mark>\n"," or more unseated attendees, where those attendees are likely to stand or move around for all or part of the event, such as music venues with standing audiences or large receptions; outdoor events with \n","<mark class=\"entity\" style=\"background: #e4e7d2; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    4,000 or more\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">CARDINAL</span>\n","</mark>\n"," unseated attendees, where those attendees are likely to stand or move around for all or part of the event, such as outdoor festivals; and any events with \n","<mark class=\"entity\" style=\"background: #e4e7d2; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    10,000\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">CARDINAL</span>\n","</mark>\n"," or more attendees indoor or outdoor, such as large sports and music events  There are some settings that will be exempt from requirements to use \n","<mark class=\"entity\" style=\"background: #bfeeb7; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    the NHS COVID Pass\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">PRODUCT</span>\n","</mark>\n"," including communal worship, wedding ceremonies, funerals and other commemorative events, protests, and mass participation sporting events. Find out more about using \n","<mark class=\"entity\" style=\"background: #bfeeb7; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    the NHS Covid Pass\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">PRODUCT</span>\n","</mark>\n",". Take a test if you do not have symptoms to help manage your risk \n","<mark class=\"entity\" style=\"background: #e4e7d2; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    Around 1\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">CARDINAL</span>\n","</mark>\n"," in \n","<mark class=\"entity\" style=\"background: #e4e7d2; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    3\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">CARDINAL</span>\n","</mark>\n"," people with COVID-19 do not have any symptoms. This means they could be spreading the virus without knowing it. Testing regularly increases the chances of detecting COVID-19 when you are infectious but are not displaying symptoms, helping to make sure you do not spread COVID-19 by staying at home and self-isolating immediately. Rapid lateral flow testing continues to be available free of charge. You can get tests from pharmacies or online. Find out more about how to get rapid lateral flow tests. You are at higher risk of catching or passing on COVID-19 in crowded and enclosed spaces, where there are more people who might be infectious and where there is limited fresh air. You may wish to take a rapid lateral flow test if it is expected there will be a period of high risk \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    that day\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n",". This is particularly important if you expect that there will be a period of high risk that day. This includes spending time in crowded and enclosed spaces, or before visiting people who are at higher risk of severe illness if they get COVID-19. Report your result and if positive, self-isolate immediately and take a PCR test. Certain places such as health and social care settings, schools and prisons have their own specific testing rules and guidance. You should always make sure you are aware of this guidance if you visit or work in these places. Try to stay at home if you’re feeling unwell If you develop COVID-19 symptoms, self-isolate immediately and get a PCR test, even if your symptoms are mild. You should self-isolate at home while you book the test and wait for the results. You must self-isolate if you test positive. If you feel unwell but do not have COVID-19 symptoms, or your COVID-19 test is negative, you may still have an illness which could be passed on to other people. Many common illnesses, like the flu or the common cold, are spread from one person to another. This can happen:  when someone infected with an illness breathes, speaks, coughs or sneezes, releasing respiratory particles which can cause infection in another person through surfaces and belongings which can also be contaminated when people who are infected with an illness cough or sneeze near them or if they touch them, the next person to touch that surface may then become infected  Staying at home until you feel better reduces the risk that you will pass on an illness to your friends, colleagues, and others in your community. This will help reduce the burden on our health services. Use the \n","<mark class=\"entity\" style=\"background: #7aecec; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    NHS\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">ORG</span>\n","</mark>\n"," COVID-19 app Using the \n","<mark class=\"entity\" style=\"background: #7aecec; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    NHS\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">ORG</span>\n","</mark>\n"," COVID-19 app helps stop the spread of the virus by informing you that you have been in close contact with someone who has since tested positive for COVID-19, even if you do not know each other. You can also use it to check in to venues with an \n","<mark class=\"entity\" style=\"background: #7aecec; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    NHS\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">ORG</span>\n","</mark>\n"," QR code and receive advice if there has been an outbreak. The app is free and easy to use and doing so can help you protect your loved ones and others. The app also allows people to report symptoms and order coronavirus tests. To help protect yourself and others, download and use the latest version of the \n","<mark class=\"entity\" style=\"background: #7aecec; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    NHS\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">ORG</span>\n","</mark>\n"," COVID-19 app. Limit close contact with other people When someone with COVID-19 breathes, speaks, coughs or sneezes, they release particles containing the virus that causes COVID-19. These particles can be breathed in by another person. You may choose to limit the close contact you have with people you do not usually live with. You may also choose to take a lateral flow test before being in close contact and also encourage those people you are meeting with to do so, which will help to manage periods of risk. This includes close contact in a higher risk environment, or when spending prolonged periods of time with a vulnerable individual. These are personal choices which can help reduce your risk of catching or spreading COVID-19. It is important to consider that others may wish to continue to take a more cautious approach. We should all be considerate of this and provide the opportunity and space for others to reduce close contacts if they wish. Wash your hands regularly and cover coughs and sneezes Wash your hands with soap and water or use hand sanitiser regularly throughout \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    the day\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n",". Regular hand washing is an effective way to reduce your risk of catching illnesses, including COVID-19. It is particularly important to wash your hands:  after coughing, sneezing and blowing your nose before you eat or handle food after coming into contact with surfaces touched by many others, such as handles, handrails and light switches after coming into contact with shared areas such as kitchens and bathrooms when you return home  Where possible, avoid touching your eyes, nose and mouth. If you do need to touch your face, for example to put on or take off your face covering, wash or sanitise your hands before and after. Coughing and sneezing increases the number of droplets and aerosols released by a person, the distance they travel and the time they stay in the air. Covering coughs and sneezes will help reduce the spread of particles carrying COVID-19 and other viruses, including those that cause coughs and colds. Understanding your personal risk in different settings and scenarios If you were previously identified as clinically extremely vulnerable (CEV) Following expert clinical advice and the successful rollout of the COVID-19 vaccine programme, people previously considered to be CEV are not being advised to shield again. If you were previously identified as CEV, you should continue to follow the guidance contained in this page. You should take advice from your health professional on whether additional precautions are right for you. If you are pregnant If you’re pregnant, your chance of getting COVID-19 is not higher than anyone else and it’s very unlikely you’ll get seriously ill with it. As a minimum, you should follow the same guidance as everyone else. If you are \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    more than 28 weeks\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n"," pregnant, or if you are pregnant and have an underlying health condition that puts you at a greater risk of severe illness from COVID-19 at any point in pregnancy, you may want to consider limiting close contact with people you do not normally meet with regularly. If you live in an area receiving an enhanced response to COVID-19 The government will work with local authorities in areas which need an enhanced response to COVID-19 to avoid the \n","<mark class=\"entity\" style=\"background: #7aecec; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    NHS\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">ORG</span>\n","</mark>\n"," facing unsustainable pressure. It is particularly important for people living in these areas to follow the guidance on this page which will help to reduce the spread of COVID-19 and to help protect yourself and others. Enhanced Response Areas will also receive additional targeted support, such as surge testing and logistical resources to maximise vaccine uptake, for a \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    5 week\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n"," period. There are currently no areas receiving an enhanced response to COVID-19. This is kept under regular review and this page will be updated if areas are added to this list. Travelling in the \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    UK\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n"," and abroad International travel You must follow the rules for international travel. You should not travel to countries or territories on the red list. Travelling to \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    England\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n"," from outside the \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    UK\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n"," What you must do when you arrive in \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    England\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n"," from abroad depends on where you have been in \n","<mark class=\"entity\" style=\"background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    the last 10 days\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">DATE</span>\n","</mark>\n"," before you arrive. People planning to travel to \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    England\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n"," should follow the guidance on entering the \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    UK\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n",". Find out which list the country you are travelling from is on and what you need to do. Travelling in the \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    UK\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n",", \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    Ireland\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n"," and \n","<mark class=\"entity\" style=\"background: #ff9561; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    Channel Islands\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">LOC</span>\n","</mark>\n"," There are no restrictions on travel within \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    England\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n",". You should check the rules at your destination if you’re planning to travel to \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    Scotland\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n",", \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    Wales\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n"," or \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    Northern Ireland\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n",", or to \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    Ireland\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n"," or \n","<mark class=\"entity\" style=\"background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    the Channel Islands\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">GPE</span>\n","</mark>\n"," as there may be restrictions in place. Do not travel if you have COVID-19 symptoms or are self-isolating. Get a PCR test and follow the stay at home guidance. Businesses and venues All businesses should follow the principles set out in the working safely guidance. Employers still have a legal duty to manage risks to those affected by their business. The way to do this is to carry out a health and safety risk assessment, including the risk of COVID-19, and to take reasonable steps to mitigate the risks you identify. \n","<mark class=\"entity\" style=\"background: #ff8197; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    The working safely guidance\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">LAW</span>\n","</mark>\n"," sets out a range of mitigations employers should consider including:  identifying poorly ventilated areas in the venue, for example by using a CO2 monitor, and taking steps to improve air flow in these areas ensuring that staff and customers who are unwell do not attend the workplace or venue providing hand sanitiser to enable staff and customers to clean their hands more frequently, and cleaning surfaces that people touch regularly communicating to staff and customers the measures you have put in place  Settings in which face coverings are required must display signage or take other measures to ensure customers are aware of the requirement to wear a face covering on their premises where there is no applicable exemption or reasonable excuse. Businesses are also encouraged to continue displaying \n","<mark class=\"entity\" style=\"background: #7aecec; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    NHS\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">ORG</span>\n","</mark>\n"," QR codes for attendees wishing to check in using the \n","<mark class=\"entity\" style=\"background: #7aecec; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    NHS\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">ORG</span>\n","</mark>\n"," COVID-19 app so they are alerted if there’s an outbreak and can take action to protect others.</div></span>"],"text/plain":["<IPython.core.display.HTML object>"]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["**********************\n","\n","\n"]}]},{"cell_type":"markdown","source":["## Dirty misc. stuff"],"metadata":{"id":"tjtcU1sPqXDA"}},{"cell_type":"code","source":["# maintain a list of entities found\n","entities = []\n","\n","for text in tqdm(df.text):\n","  # identify named entities in a sentence\n","  doc = nlp(text)\n","\n","  # if entities were found:\n","  if ent:\n","    # get the start char index, end char index, named entitiy label and text identified as a named entity\n","    labels = [[ent.start_char, ent.end_char, ent.label_] for ent in doc.ents]\n","\n","    # get useful entities which are not in our original schema, i.e. extra labels\n","    extra_labels = [[ent.start_char, ent.end_char, ent.label_] for ent in doc.ents if ent.label_ in extras]\n","\n","    # append entities to our list of entities\n","    entities.append([text, labels, extra_labels])\n","    \n","  else:\n","    # if no entities are found, then the list of entities should be empty\n","    entities.append([text,[],[]])"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":84,"referenced_widgets":["ac17b27013324b4791cd753cf8f68be0","3cb4a68409e1401d8833d783bde7e8bb","c75ff1dfd748435a8a057d8c54229a9a","86548e54b060455ebade77945d69f1a5","ecd4f80c55174fd3bcfab2bfdde65d45","ca6127aa5e0d4f9aa4e752e9eb8f05b3","f5bf0fdd75214a85976743925d307cd7","7b3b494327ed4945ace66ed651b8cbf3","46cddb14cf274818ae2dda4fd26bcb1d","6521e07816664665b8984ea984b54027","e515921f1e5e4836a4946fd1d7ad0e8b"]},"id":"L3l_k89-D8Bw","executionInfo":{"status":"ok","timestamp":1641811547844,"user_tz":0,"elapsed":774349,"user":{"displayName":"Jake Rutherford","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"06919904590009580026"}},"outputId":"ccefe83e-234a-4195-9a56-61cb601c5cee"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"ac17b27013324b4791cd753cf8f68be0","version_minor":0,"version_major":2},"text/plain":["  0%|          | 0/5905 [00:00<?, ?it/s]"]},"metadata":{}},{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/torch/autocast_mode.py:141: UserWarning: User provided device_type of 'cuda', but CUDA is not available. Disabling\n","  warnings.warn('User provided device_type of \\'cuda\\', but CUDA is not available. Disabling')\n"]}]},{"cell_type":"code","source":["preds = pd.DataFrame.from_records(entities, columns=['text','pred_labels','extra_pred_labels'])"],"metadata":{"id":"Cekrkyh6E48j"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["def charPositionLabelsToTokenMapping(labels, text, convention=None):\n","  '''\n","  Returns a list of labels, mapping to each token in a given text.\n","  This is specific to the situation in which only named entities are labelled, and those labels are not mapped\n","  directly to tokens, but are mapped to character positions.\n","\n","    Parameters:\n","      labels (list of lists): contains character positions of named entities assigned to a given label, in a given text, e.g. [[10, 38, FINANCE], [46, 54, DATE]]\n","      text (string): the string which has been labelled\n","      convention (string): tagging format to be used.\n","\n","    Returns:\n","      label_list (list): list of labels mapping to each token in text\n","    \n","  '''\n","  # flatten labels into a list of character positions\n","  positions = [index for label in labels for index in label[:2]]\n","\n","  # append None and 0 to handle edge cases\n","  positions.append(None)\n","  prev_positions = [0] + positions\n","\n","  # maintain a list of sections of text which belong to the same label\n","  sections = []\n","\n","  # identify sections of text which belong to the same label\n","  for begin, end in zip(prev_positions, positions):\n","    sections.append(text[begin:end])\n","\n","  # remove empty strings and strip spaces left over\n","  sections = [section.strip() for section in sections if section.strip()]\n","\n","  # create a dict of what text corresponds to named entities, and what\n","  # named entity that text has been labelled as\n","  if convention == 'I':\n","    named_entities = {text[i:j]:f\"I-{label}\" for i,j,label in labels}\n","  else:\n","    named_entities = {text[i:j]:f\"{label}\" for i,j,label in labels}\n","\n","  # group sections of tokens together with their label\n","  label_token_list = [(section.split(), named_entities[section]) if section in named_entities else (section.split(), 'O') for section in sections]\n","\n","  # directly map each label to a token\n","  label_list = [label_token[-1] for label_token in label_token_list for _ in label_token[0]]\n","  token_list = [token for label_token in label_token_list for token in label_token[0]]\n","\n","  return (label_list, token_list)\n"],"metadata":{"id":"e_n2es8fUyP2"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["df_preds = preds.merge(df, on='text')"],"metadata":{"id":"dylAfnFtHnCE"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# money starting char is always wrong, i.e. 1 more than it should be\n","# hence, instead of retrieving £100, it would retrieve 100\n","df_preds.pred_labels = df_preds.pred_labels.apply(lambda x: [y if y[2] != 'MONEY' else [y[0]-1,y[1],y[2]] for y in x])"],"metadata":{"id":"raYg7YcsD0Gn"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# add columns for label lists and the tokens each label maps to\n","df_preds[['pred_label_list', 'pred_text_tokens']] = df_preds.apply(lambda x: charPositionLabelsToTokenMapping(x.extra_pred_labels, x.text), axis=1, result_type='expand')\n","df_preds"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"id":"xw3M6sOqVSQ1","executionInfo":{"status":"ok","timestamp":1641811548795,"user_tz":0,"elapsed":673,"user":{"displayName":"Jake Rutherford","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"06919904590009580026"}},"outputId":"90f744db-3d7d-458c-80e7-f0c341334e18"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/html":["\n","  <div id=\"df-cf76e66b-9ae4-402f-b919-462d275e7b98\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>text</th>\n","      <th>pred_labels</th>\n","      <th>extra_pred_labels</th>\n","      <th>Unnamed: 0</th>\n","      <th>labels</th>\n","      <th>labelled_entities</th>\n","      <th>label_list</th>\n","      <th>text_tokens</th>\n","      <th>spacy_labels</th>\n","      <th>pred_label_list</th>\n","      <th>pred_text_tokens</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>If you decide not to be paid Child Benefit you...</td>\n","      <td>[]</td>\n","      <td>[]</td>\n","      <td>0</td>\n","      <td>[[29, 42, FINANCE], [48, 70, FINANCE]]</td>\n","      <td>[(Child Benefit, FINANCE), (Guardian ’ s Allow...</td>\n","      <td>[O, O, O, O, O, O, O, I-FINANCE, I-FINANCE, O,...</td>\n","      <td>[If, you, decide, not, to, be, paid, Child, Be...</td>\n","      <td>[O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, ...</td>\n","      <td>[O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, ...</td>\n","      <td>[If, you, decide, not, to, be, paid, Child, Be...</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>Moving somewhere to study does not count as no...</td>\n","      <td>[]</td>\n","      <td>[]</td>\n","      <td>1</td>\n","      <td>[[7, 16, LOCATION]]</td>\n","      <td>[(somewhere, LOCATION)]</td>\n","      <td>[O, I-LOCATION, O, O, O, O, O, O, O, O, O, O]</td>\n","      <td>[Moving, somewhere, to, study, does, not, coun...</td>\n","      <td>[O, GPE, O, O, O, O, O, O, O, O, O, O]</td>\n","      <td>[O, O, O, O, O, O, O, O, O, O, O, O]</td>\n","      <td>[Moving, somewhere, to, study, does, not, coun...</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>Your partner must apply to their own employer ...</td>\n","      <td>[]</td>\n","      <td>[]</td>\n","      <td>2</td>\n","      <td>[[5, 12, PERSON], [37, 45, ORGANIZATION], [64,...</td>\n","      <td>[(partner, PERSON), (employer, ORGANIZATION), ...</td>\n","      <td>[O, I-PERSON, O, O, O, O, O, I-ORGANIZATION, O...</td>\n","      <td>[Your, partner, must, apply, to, their, own, e...</td>\n","      <td>[O, PERSON, O, O, O, O, O, ORG, O, O, O, O, OR...</td>\n","      <td>[O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O]</td>\n","      <td>[Your, partner, must, apply, to, their, own, e...</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>You have to pay tax on it if your income is ov...</td>\n","      <td>[]</td>\n","      <td>[]</td>\n","      <td>3</td>\n","      <td>[[34, 40, FINANCE], [53, 71, FINANCE]]</td>\n","      <td>[(income, FINANCE), (Personal Allowance, FINAN...</td>\n","      <td>[O, O, O, O, O, O, O, O, O, I-FINANCE, O, O, O...</td>\n","      <td>[You, have, to, pay, tax, on, it, if, your, in...</td>\n","      <td>[O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O]</td>\n","      <td>[O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O]</td>\n","      <td>[You, have, to, pay, tax, on, it, if, your, in...</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>Apply for Widowed Parent ’ s Allowance within ...</td>\n","      <td>[[46, 54, DATE]]</td>\n","      <td>[]</td>\n","      <td>4</td>\n","      <td>[[10, 38, FINANCE], [46, 54, DATE], [70, 75, E...</td>\n","      <td>[(Widowed Parent ’ s Allowance, FINANCE), (3 m...</td>\n","      <td>[O, O, I-FINANCE, I-FINANCE, I-FINANCE, I-FINA...</td>\n","      <td>[Apply, for, Widowed, Parent, ’, s, Allowance,...</td>\n","      <td>[O, O, O, O, O, O, O, O, DATE, DATE, O, O, O, ...</td>\n","      <td>[O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, ...</td>\n","      <td>[Apply, for, Widowed, Parent, ’, s, Allowance,...</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>5900</th>\n","      <td>It ’ s against the law for a school or other e...</td>\n","      <td>[]</td>\n","      <td>[]</td>\n","      <td>450</td>\n","      <td>[[29, 35, ORGANIZATION], [45, 63, ORGANIZATION...</td>\n","      <td>[(school, ORGANIZATION), (education provider, ...</td>\n","      <td>[O, O, O, O, O, O, O, O, I-ORGANIZATION, O, O,...</td>\n","      <td>[It, ’, s, against, the, law, for, a, school, ...</td>\n","      <td>[O, O, O, O, O, O, O, O, ORG, O, O, ORG, ORG, ...</td>\n","      <td>[O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, ...</td>\n","      <td>[It, ’, s, against, the, law, for, a, school, ...</td>\n","    </tr>\n","    <tr>\n","      <th>5901</th>\n","      <td>This may mean you have difficulty getting a mo...</td>\n","      <td>[]</td>\n","      <td>[]</td>\n","      <td>451</td>\n","      <td>[[44, 52, FINANCE], [65, 69, LOCATION]]</td>\n","      <td>[(mortgage, FINANCE), (home, LOCATION)]</td>\n","      <td>[O, O, O, O, O, O, O, O, I-FINANCE, O, O, O, I...</td>\n","      <td>[This, may, mean, you, have, difficulty, getti...</td>\n","      <td>[O, O, O, O, O, O, O, O, O, O, O, O, GPE, O]</td>\n","      <td>[O, O, O, O, O, O, O, O, O, O, O, O, O, O]</td>\n","      <td>[This, may, mean, you, have, difficulty, getti...</td>\n","    </tr>\n","    <tr>\n","      <th>5902</th>\n","      <td>The qualified person can include you if they a...</td>\n","      <td>[]</td>\n","      <td>[]</td>\n","      <td>453</td>\n","      <td>[[4, 20, PERSON], [62, 81, STATE]]</td>\n","      <td>[(qualified person, PERSON), (permanent reside...</td>\n","      <td>[O, I-PERSON, I-PERSON, O, O, O, O, O, O, O, O...</td>\n","      <td>[The, qualified, person, can, include, you, if...</td>\n","      <td>[O, PERSON, PERSON, O, O, O, O, O, O, O, O, O,...</td>\n","      <td>[O, O, O, O, O, O, O, O, O, O, O, O, O, O]</td>\n","      <td>[The, qualified, person, can, include, you, if...</td>\n","    </tr>\n","    <tr>\n","      <th>5903</th>\n","      <td>You must see a border officer when you arrive ...</td>\n","      <td>[[53, 55, GPE], [73, 82, PRODUCT]]</td>\n","      <td>[[73, 82, PRODUCT]]</td>\n","      <td>454</td>\n","      <td>[[15, 29, PERSON], [53, 55, LOCATION]]</td>\n","      <td>[(border officer, PERSON), (UK, LOCATION)]</td>\n","      <td>[O, O, O, O, I-PERSON, I-PERSON, O, O, O, O, O...</td>\n","      <td>[You, must, see, a, border, officer, when, you...</td>\n","      <td>[O, O, O, O, PERSON, PERSON, O, O, O, O, O, GP...</td>\n","      <td>[O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, ...</td>\n","      <td>[You, must, see, a, border, officer, when, you...</td>\n","    </tr>\n","    <tr>\n","      <th>5904</th>\n","      <td>If you ’ ve not been granted a parental order ...</td>\n","      <td>[[82, 84, GPE]]</td>\n","      <td>[]</td>\n","      <td>455</td>\n","      <td>[[21, 45, EVENT], [55, 60, PERSON], [65, 69, E...</td>\n","      <td>[(granted a parental order, EVENT), (child, PE...</td>\n","      <td>[O, O, O, O, O, O, I-EVENT, I-EVENT, I-EVENT, ...</td>\n","      <td>[If, you, ’, ve, not, been, granted, a, parent...</td>\n","      <td>[O, O, O, O, O, O, EVENT, EVENT, EVENT, EVENT,...</td>\n","      <td>[O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, ...</td>\n","      <td>[If, you, ’, ve, not, been, granted, a, parent...</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>5905 rows × 11 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-cf76e66b-9ae4-402f-b919-462d275e7b98')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-cf76e66b-9ae4-402f-b919-462d275e7b98 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-cf76e66b-9ae4-402f-b919-462d275e7b98');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "],"text/plain":["                                                   text  ...                                   pred_text_tokens\n","0     If you decide not to be paid Child Benefit you...  ...  [If, you, decide, not, to, be, paid, Child, Be...\n","1     Moving somewhere to study does not count as no...  ...  [Moving, somewhere, to, study, does, not, coun...\n","2     Your partner must apply to their own employer ...  ...  [Your, partner, must, apply, to, their, own, e...\n","3     You have to pay tax on it if your income is ov...  ...  [You, have, to, pay, tax, on, it, if, your, in...\n","4     Apply for Widowed Parent ’ s Allowance within ...  ...  [Apply, for, Widowed, Parent, ’, s, Allowance,...\n","...                                                 ...  ...                                                ...\n","5900  It ’ s against the law for a school or other e...  ...  [It, ’, s, against, the, law, for, a, school, ...\n","5901  This may mean you have difficulty getting a mo...  ...  [This, may, mean, you, have, difficulty, getti...\n","5902  The qualified person can include you if they a...  ...  [The, qualified, person, can, include, you, if...\n","5903  You must see a border officer when you arrive ...  ...  [You, must, see, a, border, officer, when, you...\n","5904  If you ’ ve not been granted a parental order ...  ...  [If, you, ’, ve, not, been, granted, a, parent...\n","\n","[5905 rows x 11 columns]"]},"metadata":{},"execution_count":25}]},{"cell_type":"code","source":["df_preds['pred_label_list_gov_schema'] = df_preds.pred_label_list.apply(lambda x: [spacy2gov[label] for label in x])"],"metadata":{"id":"50y1OJsF8wND"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["df_preds"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"id":"hi0fdEZm9TAF","executionInfo":{"status":"ok","timestamp":1641811549262,"user_tz":0,"elapsed":13,"user":{"displayName":"Jake Rutherford","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"06919904590009580026"}},"outputId":"78f22809-d5e9-41c2-80c9-9aee5589f5ac"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/html":["\n","  <div id=\"df-a16d209f-f1fd-4d6f-b70a-fd83a9cbdeab\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>text</th>\n","      <th>pred_labels</th>\n","      <th>extra_pred_labels</th>\n","      <th>Unnamed: 0</th>\n","      <th>labels</th>\n","      <th>labelled_entities</th>\n","      <th>label_list</th>\n","      <th>text_tokens</th>\n","      <th>spacy_labels</th>\n","      <th>pred_label_list</th>\n","      <th>pred_text_tokens</th>\n","      <th>pred_label_list_gov_schema</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>If you decide not to be paid Child Benefit you...</td>\n","      <td>[]</td>\n","      <td>[]</td>\n","      <td>0</td>\n","      <td>[[29, 42, FINANCE], [48, 70, FINANCE]]</td>\n","      <td>[(Child Benefit, FINANCE), (Guardian ’ s Allow...</td>\n","      <td>[O, O, O, O, O, O, O, I-FINANCE, I-FINANCE, O,...</td>\n","      <td>[If, you, decide, not, to, be, paid, Child, Be...</td>\n","      <td>[O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, ...</td>\n","      <td>[O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, ...</td>\n","      <td>[If, you, decide, not, to, be, paid, Child, Be...</td>\n","      <td>[O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, ...</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>Moving somewhere to study does not count as no...</td>\n","      <td>[]</td>\n","      <td>[]</td>\n","      <td>1</td>\n","      <td>[[7, 16, LOCATION]]</td>\n","      <td>[(somewhere, LOCATION)]</td>\n","      <td>[O, I-LOCATION, O, O, O, O, O, O, O, O, O, O]</td>\n","      <td>[Moving, somewhere, to, study, does, not, coun...</td>\n","      <td>[O, GPE, O, O, O, O, O, O, O, O, O, O]</td>\n","      <td>[O, O, O, O, O, O, O, O, O, O, O, O]</td>\n","      <td>[Moving, somewhere, to, study, does, not, coun...</td>\n","      <td>[O, O, O, O, O, O, O, O, O, O, O, O]</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>Your partner must apply to their own employer ...</td>\n","      <td>[]</td>\n","      <td>[]</td>\n","      <td>2</td>\n","      <td>[[5, 12, PERSON], [37, 45, ORGANIZATION], [64,...</td>\n","      <td>[(partner, PERSON), (employer, ORGANIZATION), ...</td>\n","      <td>[O, I-PERSON, O, O, O, O, O, I-ORGANIZATION, O...</td>\n","      <td>[Your, partner, must, apply, to, their, own, e...</td>\n","      <td>[O, PERSON, O, O, O, O, O, ORG, O, O, O, O, OR...</td>\n","      <td>[O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O]</td>\n","      <td>[Your, partner, must, apply, to, their, own, e...</td>\n","      <td>[O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O]</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>You have to pay tax on it if your income is ov...</td>\n","      <td>[]</td>\n","      <td>[]</td>\n","      <td>3</td>\n","      <td>[[34, 40, FINANCE], [53, 71, FINANCE]]</td>\n","      <td>[(income, FINANCE), (Personal Allowance, FINAN...</td>\n","      <td>[O, O, O, O, O, O, O, O, O, I-FINANCE, O, O, O...</td>\n","      <td>[You, have, to, pay, tax, on, it, if, your, in...</td>\n","      <td>[O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O]</td>\n","      <td>[O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O]</td>\n","      <td>[You, have, to, pay, tax, on, it, if, your, in...</td>\n","      <td>[O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O]</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>Apply for Widowed Parent ’ s Allowance within ...</td>\n","      <td>[[46, 54, DATE]]</td>\n","      <td>[]</td>\n","      <td>4</td>\n","      <td>[[10, 38, FINANCE], [46, 54, DATE], [70, 75, E...</td>\n","      <td>[(Widowed Parent ’ s Allowance, FINANCE), (3 m...</td>\n","      <td>[O, O, I-FINANCE, I-FINANCE, I-FINANCE, I-FINA...</td>\n","      <td>[Apply, for, Widowed, Parent, ’, s, Allowance,...</td>\n","      <td>[O, O, O, O, O, O, O, O, DATE, DATE, O, O, O, ...</td>\n","      <td>[O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, ...</td>\n","      <td>[Apply, for, Widowed, Parent, ’, s, Allowance,...</td>\n","      <td>[O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, ...</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>5900</th>\n","      <td>It ’ s against the law for a school or other e...</td>\n","      <td>[]</td>\n","      <td>[]</td>\n","      <td>450</td>\n","      <td>[[29, 35, ORGANIZATION], [45, 63, ORGANIZATION...</td>\n","      <td>[(school, ORGANIZATION), (education provider, ...</td>\n","      <td>[O, O, O, O, O, O, O, O, I-ORGANIZATION, O, O,...</td>\n","      <td>[It, ’, s, against, the, law, for, a, school, ...</td>\n","      <td>[O, O, O, O, O, O, O, O, ORG, O, O, ORG, ORG, ...</td>\n","      <td>[O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, ...</td>\n","      <td>[It, ’, s, against, the, law, for, a, school, ...</td>\n","      <td>[O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, ...</td>\n","    </tr>\n","    <tr>\n","      <th>5901</th>\n","      <td>This may mean you have difficulty getting a mo...</td>\n","      <td>[]</td>\n","      <td>[]</td>\n","      <td>451</td>\n","      <td>[[44, 52, FINANCE], [65, 69, LOCATION]]</td>\n","      <td>[(mortgage, FINANCE), (home, LOCATION)]</td>\n","      <td>[O, O, O, O, O, O, O, O, I-FINANCE, O, O, O, I...</td>\n","      <td>[This, may, mean, you, have, difficulty, getti...</td>\n","      <td>[O, O, O, O, O, O, O, O, O, O, O, O, GPE, O]</td>\n","      <td>[O, O, O, O, O, O, O, O, O, O, O, O, O, O]</td>\n","      <td>[This, may, mean, you, have, difficulty, getti...</td>\n","      <td>[O, O, O, O, O, O, O, O, O, O, O, O, O, O]</td>\n","    </tr>\n","    <tr>\n","      <th>5902</th>\n","      <td>The qualified person can include you if they a...</td>\n","      <td>[]</td>\n","      <td>[]</td>\n","      <td>453</td>\n","      <td>[[4, 20, PERSON], [62, 81, STATE]]</td>\n","      <td>[(qualified person, PERSON), (permanent reside...</td>\n","      <td>[O, I-PERSON, I-PERSON, O, O, O, O, O, O, O, O...</td>\n","      <td>[The, qualified, person, can, include, you, if...</td>\n","      <td>[O, PERSON, PERSON, O, O, O, O, O, O, O, O, O,...</td>\n","      <td>[O, O, O, O, O, O, O, O, O, O, O, O, O, O]</td>\n","      <td>[The, qualified, person, can, include, you, if...</td>\n","      <td>[O, O, O, O, O, O, O, O, O, O, O, O, O, O]</td>\n","    </tr>\n","    <tr>\n","      <th>5903</th>\n","      <td>You must see a border officer when you arrive ...</td>\n","      <td>[[53, 55, GPE], [73, 82, PRODUCT]]</td>\n","      <td>[[73, 82, PRODUCT]]</td>\n","      <td>454</td>\n","      <td>[[15, 29, PERSON], [53, 55, LOCATION]]</td>\n","      <td>[(border officer, PERSON), (UK, LOCATION)]</td>\n","      <td>[O, O, O, O, I-PERSON, I-PERSON, O, O, O, O, O...</td>\n","      <td>[You, must, see, a, border, officer, when, you...</td>\n","      <td>[O, O, O, O, PERSON, PERSON, O, O, O, O, O, GP...</td>\n","      <td>[O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, ...</td>\n","      <td>[You, must, see, a, border, officer, when, you...</td>\n","      <td>[O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, ...</td>\n","    </tr>\n","    <tr>\n","      <th>5904</th>\n","      <td>If you ’ ve not been granted a parental order ...</td>\n","      <td>[[82, 84, GPE]]</td>\n","      <td>[]</td>\n","      <td>455</td>\n","      <td>[[21, 45, EVENT], [55, 60, PERSON], [65, 69, E...</td>\n","      <td>[(granted a parental order, EVENT), (child, PE...</td>\n","      <td>[O, O, O, O, O, O, I-EVENT, I-EVENT, I-EVENT, ...</td>\n","      <td>[If, you, ’, ve, not, been, granted, a, parent...</td>\n","      <td>[O, O, O, O, O, O, EVENT, EVENT, EVENT, EVENT,...</td>\n","      <td>[O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, ...</td>\n","      <td>[If, you, ’, ve, not, been, granted, a, parent...</td>\n","      <td>[O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, ...</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>5905 rows × 12 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-a16d209f-f1fd-4d6f-b70a-fd83a9cbdeab')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-a16d209f-f1fd-4d6f-b70a-fd83a9cbdeab button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-a16d209f-f1fd-4d6f-b70a-fd83a9cbdeab');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "],"text/plain":["                                                   text  ...                         pred_label_list_gov_schema\n","0     If you decide not to be paid Child Benefit you...  ...  [O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, ...\n","1     Moving somewhere to study does not count as no...  ...               [O, O, O, O, O, O, O, O, O, O, O, O]\n","2     Your partner must apply to their own employer ...  ...   [O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O]\n","3     You have to pay tax on it if your income is ov...  ...   [O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O]\n","4     Apply for Widowed Parent ’ s Allowance within ...  ...  [O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, ...\n","...                                                 ...  ...                                                ...\n","5900  It ’ s against the law for a school or other e...  ...  [O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, ...\n","5901  This may mean you have difficulty getting a mo...  ...         [O, O, O, O, O, O, O, O, O, O, O, O, O, O]\n","5902  The qualified person can include you if they a...  ...         [O, O, O, O, O, O, O, O, O, O, O, O, O, O]\n","5903  You must see a border officer when you arrive ...  ...  [O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, ...\n","5904  If you ’ ve not been granted a parental order ...  ...  [O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, ...\n","\n","[5905 rows x 12 columns]"]},"metadata":{},"execution_count":27}]},{"cell_type":"code","source":["np.sum([len(x) for x in df_preds.label_list]),np.sum([len(x) for x in df_preds.pred_text_tokens]),np.sum([len(x) for x in df_preds.pred_label_list_gov_schema])"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"I1x8LDw8_r9H","executionInfo":{"status":"ok","timestamp":1641811549262,"user_tz":0,"elapsed":11,"user":{"displayName":"Jake Rutherford","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"06919904590009580026"}},"outputId":"07011a3d-c473-4514-8637-50e888eedf57"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(105812, 105776, 105776)"]},"metadata":{},"execution_count":28}]},{"cell_type":"code","source":["for i,(x,y,z) in enumerate(zip(df_preds.text_tokens, df_preds.pred_text_tokens, df_preds.text)):\n","  if len(x) != len(y):\n","    if i > 1000:\n","      print(x)\n","      print(y)\n","      print(z)\n","      break"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"0A0R-pbUAker","executionInfo":{"status":"ok","timestamp":1641811567280,"user_tz":0,"elapsed":194,"user":{"displayName":"Jake Rutherford","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"06919904590009580026"}},"outputId":"8467bbde-7987-4f3f-d439-9fe078e8f88e"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["['Ben', 'efits', 'Claiming', 'Care', 'to', 'Learn', 'will', 'not', 'affect', 'your', 'family', '’', 's', 'benefits', 'or', 'allowances', '.']\n","['Benefits', 'Claiming', 'Care', 'to', 'Learn', 'will', 'not', 'affect', 'your', 'family', '’', 's', 'benefits', 'or', 'allowances', '.']\n","Benefits Claiming Care to Learn will not affect your family ’ s benefits or allowances .\n"]}]},{"cell_type":"code","source":["df_preds.iloc[i]"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"6y2I4R9tCAKP","executionInfo":{"status":"ok","timestamp":1641776176836,"user_tz":0,"elapsed":190,"user":{"displayName":"Jake Rutherford","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"06919904590009580026"}},"outputId":"fc8759ae-a42e-457e-87e9-c6e06c1e7330"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["text                          Benefits Claiming Care to Learn will not affec...\n","pred_labels                                                                  []\n","extra_pred_labels                                                            []\n","Unnamed: 0                                                                  290\n","labels                        [[3, 32, FINANCE], [53, 59, PERSON], [64, 72, ...\n","labelled_entities             [(efits Claiming Care to Learn , FINANCE), (fa...\n","label_list                    [O, O, O, O, O, O, O, O, O, O, I-PERSON, O, O,...\n","text_tokens                   [Ben, efits, Claiming, Care, to, Learn, will, ...\n","spacy_labels                  [O, O, O, O, O, O, O, O, O, O, PERSON, O, O, O...\n","pred_label_list                [O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O]\n","pred_text_tokens              [Benefits, Claiming, Care, to, Learn, will, no...\n","pred_label_list_gov_schema     [O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O]\n","Name: 1403, dtype: object"]},"metadata":{},"execution_count":46}]},{"cell_type":"code","source":["df_preds.iloc[i].text[101:114]"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":35},"id":"sqvVw59pCHWW","executionInfo":{"status":"ok","timestamp":1641769947089,"user_tz":0,"elapsed":388,"user":{"displayName":"Jake Rutherford","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"06919904590009580026"}},"outputId":"60a8941c-ae81-4e4f-a6cc-0e6d2a82448c"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"},"text/plain":["'up to 6 weeks'"]},"metadata":{},"execution_count":78}]},{"cell_type":"code","source":["y_preds = [y for labels in df_preds.pred_label_list_gov_schema for y in labels]\n","y_true = [y for labels in df_preds.label_list for y in labels]"],"metadata":{"id":"jwF4NVkj9hE1"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["len(y_preds), len(y_true)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"5bymwRUX_bGa","executionInfo":{"status":"ok","timestamp":1641767889039,"user_tz":0,"elapsed":514,"user":{"displayName":"Jake Rutherford","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"06919904590009580026"}},"outputId":"6978a1b1-79ae-4050-c8d8-9c5c3cc77223"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(105798, 105823)"]},"metadata":{},"execution_count":38}]},{"cell_type":"code","source":["from sklearn.metrics import confusion_matrix\n","cm = confusion_matrix(y_true, y_preds)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":329},"id":"ZNbRdWNH-Ro7","executionInfo":{"status":"error","timestamp":1641767823825,"user_tz":0,"elapsed":535,"user":{"displayName":"Jake Rutherford","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"06919904590009580026"}},"outputId":"2dd68a51-d94f-48d3-d530-e021223339ce"},"execution_count":null,"outputs":[{"output_type":"error","ename":"ValueError","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mValueError\u001b[0m                                Traceback (most recent call last)","\u001b[0;32m<ipython-input-37-19fe009be035>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n\u001b[1;32m      1\u001b[0m \u001b[0;32mfrom\u001b[0m \u001b[0msklearn\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mmetrics\u001b[0m \u001b[0;32mimport\u001b[0m \u001b[0mconfusion_matrix\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 2\u001b[0;31m \u001b[0mcm\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mconfusion_matrix\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0my_true\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0my_preds\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/sklearn/metrics/_classification.py\u001b[0m in \u001b[0;36mconfusion_matrix\u001b[0;34m(y_true, y_pred, labels, sample_weight, normalize)\u001b[0m\n\u001b[1;32m    300\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    301\u001b[0m     \"\"\"\n\u001b[0;32m--> 302\u001b[0;31m     \u001b[0my_type\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0my_true\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0my_pred\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0m_check_targets\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0my_true\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0my_pred\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    303\u001b[0m     \u001b[0;32mif\u001b[0m \u001b[0my_type\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0;32min\u001b[0m \u001b[0;34m(\u001b[0m\u001b[0;34m\"binary\"\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m\"multiclass\"\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    304\u001b[0m         \u001b[0;32mraise\u001b[0m \u001b[0mValueError\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"%s is not supported\"\u001b[0m \u001b[0;34m%\u001b[0m \u001b[0my_type\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/sklearn/metrics/_classification.py\u001b[0m in \u001b[0;36m_check_targets\u001b[0;34m(y_true, y_pred)\u001b[0m\n\u001b[1;32m     82\u001b[0m     \u001b[0my_pred\u001b[0m \u001b[0;34m:\u001b[0m \u001b[0marray\u001b[0m \u001b[0;32mor\u001b[0m \u001b[0mindicator\u001b[0m \u001b[0mmatrix\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     83\u001b[0m     \"\"\"\n\u001b[0;32m---> 84\u001b[0;31m     \u001b[0mcheck_consistent_length\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0my_true\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0my_pred\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     85\u001b[0m     \u001b[0mtype_true\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mtype_of_target\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0my_true\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     86\u001b[0m     \u001b[0mtype_pred\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mtype_of_target\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0my_pred\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/sklearn/utils/validation.py\u001b[0m in \u001b[0;36mcheck_consistent_length\u001b[0;34m(*arrays)\u001b[0m\n\u001b[1;32m    331\u001b[0m         raise ValueError(\n\u001b[1;32m    332\u001b[0m             \u001b[0;34m\"Found input variables with inconsistent numbers of samples: %r\"\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 333\u001b[0;31m             \u001b[0;34m%\u001b[0m \u001b[0;34m[\u001b[0m\u001b[0mint\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0ml\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0ml\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mlengths\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    334\u001b[0m         )\n\u001b[1;32m    335\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mValueError\u001b[0m: Found input variables with inconsistent numbers of samples: [105823, 105798]"]}]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true,"base_uri":"https://localhost:8080/","height":104,"referenced_widgets":["00a1643c9ea746c2984540e72eb9525a","173b8a879c1c4be380b52587ce9c349a","063715dca5b44ec49fce3319857bbc85","5c8e8bddd7de447fa55156a0d9b48c50","00d6e3c67cec4f8f92ebef48a41aca72","04caa11f654f46139733c8b2ff292a1b","ebeda7bc5f6c45f284eb114f5cb07f2b","ede6080f822a45ab87162145cf3a9b90","a43ac5e1b01643ae804018ebb435a137","2ca57c8d137142b3935b4fb12481e63b","099ff583299b4eab81c853dd4c8291e3"]},"id":"D2ke2W0ALm3u","outputId":"b46455b6-cda9-4e86-b466-3fd98c0a825d"},"outputs":[{"data":{"application/vnd.jupyter.widget-view+json":{"model_id":"00a1643c9ea746c2984540e72eb9525a","version_major":2,"version_minor":0},"text/plain":["  0%|          | 0/5000 [00:00<?, ?it/s]"]},"metadata":{},"output_type":"display_data"},{"name":"stdout","output_type":"stream","text":["Match: the British + High Commission ,in: Accordingly the FCO and the British High Commission Port Louis will not be liable for any inaccuracies in this information .\n","Match: OFT/ + DECC ,in: Green Deal : OFT/ DECC joint guidance for providers .\n","Match: India + India ,in: Information on legal issues relating to parental child abduction Information on legal issues relating to parental child abduction in India India - Child Abduction .\n","Match: 1 + 0 ,in: The U.S. women 's soccer ( football ) team has defeated Sweden , 1-0 , in an Olympic prep match in Skelleftea , Sweden .\n","Match: Calderbridge + Cumbria ,in: LLW Repository Ltd Pelham House Pelham Drive Calderbridge Cumbria CA20 1DB Email nwp @ llwrsite.com Telephone 019467 22740\n","Match: 324 + 34 ,in: Stamp Duty rates : leasehold - on lease premium For rates before 2000 , see the Stamp Taxes Manual appendix C pages 324-34 .\n","Match: chapter 5 of + the RDR3 : Statutory Residence Test ,in: More information on split years and the Statutory Residence Test ( SRT ) can be found in chapter 5 of the RDR3 : Statutory Residence Test .\n","Match: Linda Sloan + Joyce Allen ,in: Linda Sloan Joyce Allen - 07946121910 Department for Transport ( DfT ) .\n","Match: Iraqi + Shi'ite ,in: Meanwhile , Iraqi Shi'ite and Kurdish negotiators seeking agreement on the makeup of a new government are meeting today , before parliament 's next session Wednesday .\n","Match: Sweet and Maxwell ’ s + Criminal Law Review ,in: This article ‘ Forensic science evidence in question ’ was published in Sweet and Maxwell ’ s Criminal Law Review ( Issue 5 , 2011 ) .\n"]}],"source":["# finding multi token entities\n","matches = []\n","sample_df = df.text.sample(5000)\n","for text in tqdm(sample_df):\n","  doc = nlp(text)\n","  if doc.ents:\n","    entities = [[ent.start_char, ent.end_char, ent.label_, ent.text] for ent in doc.ents]\n","    for A, B in zip(entities,entities[1:]):\n","      if (A[1] + 1 == B[0]) and (A[2] == B[2]):\n","        matches.append([doc,A,B])\n","        print('Match:', A[3],'+', B[3], ',in:',doc)"]},{"cell_type":"code","source":["# finding bad labels\n","i = 0\n","screw_up = []\n","for text,labels in zip(df.text, df.labels):\n","  label_pos = [label for labla in labels for label in labla]\n","\n","  if 'pm ' in text and 'MONEY' in label_pos:\n","    screw_up.append([(text[i-3:j+2],x) for i,j,x in labels if x == 'MONEY'])\n","\n","  # if 'MONEY' in label_pos and 'FINANCE' in label_pos:\n","  #   i += 1\n","  #   if i == 822:\n","  #     break\n","\n","print(text)\n","\n","[(text[i:j],x) for i,j,x in labels]"],"metadata":{"id":"XiPirrZvIjFV"},"execution_count":null,"outputs":[]}],"metadata":{"accelerator":"GPU","colab":{"name":"012_SpaCy_NER","provenance":[],"collapsed_sections":[],"authorship_tag":"ABX9TyPQDLnraWUsUW4w/8+gFDkJ"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"},"widgets":{"application/vnd.jupyter.widget-state+json":{"00a1643c9ea746c2984540e72eb9525a":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_173b8a879c1c4be380b52587ce9c349a","IPY_MODEL_063715dca5b44ec49fce3319857bbc85","IPY_MODEL_5c8e8bddd7de447fa55156a0d9b48c50"],"layout":"IPY_MODEL_00d6e3c67cec4f8f92ebef48a41aca72"}},"00d6e3c67cec4f8f92ebef48a41aca72":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"04caa11f654f46139733c8b2ff292a1b":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"063715dca5b44ec49fce3319857bbc85":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"","description":"","description_tooltip":null,"layout":"IPY_MODEL_ede6080f822a45ab87162145cf3a9b90","max":5000,"min":0,"orientation":"horizontal","style":"IPY_MODEL_a43ac5e1b01643ae804018ebb435a137","value":889}},"099ff583299b4eab81c853dd4c8291e3":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"173b8a879c1c4be380b52587ce9c349a":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_04caa11f654f46139733c8b2ff292a1b","placeholder":"​","style":"IPY_MODEL_ebeda7bc5f6c45f284eb114f5cb07f2b","value":" 18%"}},"2ca57c8d137142b3935b4fb12481e63b":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5c8e8bddd7de447fa55156a0d9b48c50":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_2ca57c8d137142b3935b4fb12481e63b","placeholder":"​","style":"IPY_MODEL_099ff583299b4eab81c853dd4c8291e3","value":" 889/5000 [02:05&lt;08:48,  7.78it/s]"}},"a43ac5e1b01643ae804018ebb435a137":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"ebeda7bc5f6c45f284eb114f5cb07f2b":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"ede6080f822a45ab87162145cf3a9b90":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ac17b27013324b4791cd753cf8f68be0":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_3cb4a68409e1401d8833d783bde7e8bb","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_c75ff1dfd748435a8a057d8c54229a9a","IPY_MODEL_86548e54b060455ebade77945d69f1a5","IPY_MODEL_ecd4f80c55174fd3bcfab2bfdde65d45"]}},"3cb4a68409e1401d8833d783bde7e8bb":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"c75ff1dfd748435a8a057d8c54229a9a":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_ca6127aa5e0d4f9aa4e752e9eb8f05b3","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_f5bf0fdd75214a85976743925d307cd7"}},"86548e54b060455ebade77945d69f1a5":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_7b3b494327ed4945ace66ed651b8cbf3","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":5905,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":5905,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_46cddb14cf274818ae2dda4fd26bcb1d"}},"ecd4f80c55174fd3bcfab2bfdde65d45":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_6521e07816664665b8984ea984b54027","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 5905/5905 [12:54&lt;00:00,  6.76it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_e515921f1e5e4836a4946fd1d7ad0e8b"}},"ca6127aa5e0d4f9aa4e752e9eb8f05b3":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"f5bf0fdd75214a85976743925d307cd7":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"7b3b494327ed4945ace66ed651b8cbf3":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"46cddb14cf274818ae2dda4fd26bcb1d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"6521e07816664665b8984ea984b54027":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"e515921f1e5e4836a4946fd1d7ad0e8b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}}}}},"nbformat":4,"nbformat_minor":0}